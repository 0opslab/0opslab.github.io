import{_ as e,o,c as t,e as s}from"./app.a667bd71.js";const p={},r=s("<p>1\u53EF\u4EE5\u5F97\u51FAfilename\u6B63\u5728\u8FD0\u884C\u7684\u8FDB\u7A0B #pidof filename 2\u53EF\u4EE5\u901A\u8FC7\u6587\u4EF6\u6216\u8005tcp udp\u534F\u8BAE\u770B\u5230\u8FDB\u7A0B #fuser -n tcp port 3\u53EF\u4EE5\u770B\u6587\u4EF6\u4FEE\u6539\u65F6\u95F4\uFF0C\u5927\u5C0F\u7B49\u4FE1\u606F #stat filename 4\u770B\u52A0\u8F7D\u6A21\u5757 #lsmod 5\u770Brpc\u670D\u52A1\u5F00\u653E #rpcinfo -p 6\u770B\u7F51\u5361\u662F\u5426\u6DF7\u6742\u6A21\u5F0F(promiscuous mod) #dmesg|grep eth0</p><p>7\u770B\u547D\u4EE4\u662F\u5426\u88AB\u66F4\u6539\uFF0C\u8C61md5sum\u4E00\u6837 #rpm -Vf /bin/ls rpm -Vf /bin/ps\u6B63\u5E38\u65E0\u8F93\u51FA\uFF0C\u5426\u5219\u8F93\u51FASM5\u2026.T /bin/su\u4E4B\u7C7B\u63D0\u793A \u5982\u679Crpm\u7684\u6570\u636E\u5E93\u88AB\u4FEE\u6539\u5219\u4E0D\u53EF\u9760\u4E86\uFF0C\u53EA\u80FD\u901A\u8FC7\u7F51\u7EDC\u6216\u5219cdrom\u4E2D\u7684rpm\u6570\u636E\u5E93\u6765\u6BD4\u8F83 \u5982\uFF1Arpm -Vvp ftp://mirror.site/dir/RedHat/RPMS/fileutils-3.16-10.i386.rpm \u4EE5\u4E0B\u5E38\u7528\u547D\u4EE4\u9700\u8981\u68C0\u67E5 /usr/bin/chfn usr/bin/chsh /bin/login /bin/ls /usr/bin/passwd /bin/ps /usr/bin/top /usr/sbin/in.rshd /bin/netstat /sbin/ifconfig /usr/sbin/syslogd /usr/sbin/inetd /usr/sbin/tcpd /usr/bin/killall /sbin/pidof /usr/bin/find</p><p>8\u5982\u679C\u68C0\u67E5\u7684\u662F\u5DF2\u7ECF\u786E\u8BA4\u88AB\u9ED1\u5BA2\u653B\u51FB\u7684\u673A\u5668\uFF0C\u5B8C\u7F8E\u5EFA\u8BAE\uFF1A 1.dd\u4E00\u4E2A\u5907\u4EFD\u786C\u76D8\u4E0A 2.mount \u4E00\u4E2A\u5149\u9A71\uFF0C\u4E0A\u9762\u6709\u9759\u6001\u7F16\u8BD1\u597D\u7684\u7A0B\u5E8Fls ps netstat\u7B49\u5E38\u7528\u5DE5\u5177 3.\u7528nc\u628A\u6267\u884C\u6B65\u9AA4\u8F93\u51FA\u5230\u8FDC\u7A0B\u673A\u5668\u4E0A</p><p>9\u7528md5sum\u4FDD\u5B58\u4E00\u4E2A\u5168\u5C40\u7684\u6587\u4EF6 find /sbin -type f|xargs md5sum &gt;1st \u68C0\u67E5\u662F\u5426\u6539\u53D8 md5sum -c 1st|grep OK</p><p>10\u907F\u514D\u5728\u5DF2\u7ECF\u653B\u51FB\u7684\u673A\u5668\u4E0A\u8FC7\u591A\u5199\u64CD\u4F5C\uFF0C\u53EF\u4EE5\uFF1A 1.\u5728\u53E6\u4E00\u4E2A\u673A\u5668192.168.20.191\u4E0A\u8FD0\u884C nc -L -p 1234 &gt;some_audit_output.log \u6CE8\u610FL\u662F\u5927\u5199\uFF0C\u53EF\u4EE5\u6C38\u4E45\u4FA6\u542C 2.\u88AB\u653B\u51FB\u673A\u5668\u4E0A\u8FD0\u884C command|nc 192.168.20.191 1234 \u6216 script &gt;/mnt/export.log \u68C0\u6D4B\u5B8C\u6BD5\u540E\u7528ctrl+d\u4FDD\u5B58\u8BB0\u5F55</p><p>11\u901A\u8FC7\u8FDB\u7A0B\u67E5\u627E\u53EF\u7591\u7A0B\u5E8F\u65B9\u6CD5\uFF1A 1.netstat -anp \u8FD9\u6B65\u4E3B\u8981\u9760\u7ECF\u9A8C\uFF0C\u628A\u53EF\u7591\u7684\u90FD\u8BB0\u5F55\u4E0B\u6765 2.\u8FDB\u5165\u5185\u5B58\u76EE\u5F55 cd /proc/3299 3. ls -la\uFF0C\u4E00\u822Cexe\u53EF\u4EE5\u770B\u5230\u6267\u884C\u6587\u4EF6\u8DEF\u5F84\uFF0C 4.\u518D\u8FDB\u5165fd\u76EE\u5F55\u67E5\u770B\u6587\u4EF6\u53E5\u67C4\uFF0C\u81F3\u6B64\u4E00\u822C\u90FD\u53EF\u4EE5\u627E\u51FA\u6267\u884C\u7A0B\u5E8F 5.ps -awx \u628A\u521A\u624D\u53EF\u7591\u7684\u8FDB\u7A0B\u89C2\u5BDF\u4E00\u904D</p><p>12\u5982\u679Chacker\u628A\u65E5\u5FD7\u5220\u9664\u4E86\uFF1A 1.\u67E5\u627E\u6240\u6709\u672A\u88AB\u5220\u9664\u5F7B\u5E95\u7684\u65E5\u5FD7\uFF0C\u6BD4\u5982history\uFF0Csniffer\u65E5\u5FD7 2./proc/pid/fd \u76EE\u5F55\u91CC\u63D0\u793A\u5DF2\u7ECF\u5220\u9664\u7684\u6587\u4EF6 l-wx\u2014\u2014 1 root root 64 Aug 10 20:54 15 -&gt; /var/log/httpd/error_log (deleted) l-wx\u2014\u2014 1 root root 64 Aug 10 20:54 18 -&gt; /var/log/httpd/ssl_engine_log (deleted) l-wx\u2014\u2014 1 root root 64 Aug 10 20:54 19 -&gt; /var/log/httpd/ssl_mutex.800 (deleted) l-wx\u2014\u2014 1 root root 64 Aug 10 20:54 20 -&gt; /var/log/httpd/access_log (deleted) l-wx\u2014\u2014 1 root root 64 Aug 10 20:54 21 -&gt; /var/log/httpd/access_log (deleted) l-wx\u2014\u2014 1 root root 64 Aug 10 20:54 22 -&gt; /var/log/httpd/ssl_request_log (deleted) l-wx\u2014\u2014 1 root root 64 Aug 10 20:54 23 -&gt; /var/log/httpd/ssl_mutex.800 (deleted) lrwx\u2014\u2014 1 root root 64 Aug 10 20:54 3 -&gt; /var/run/httpd.mm.800.sem (deleted) lrwx\u2014\u2014 1 root root 64 Aug 10 20:54 4 -&gt; /var/log/httpd/ssl_scache.sem (deleted)</p><p>3.\u7528\u9759\u6001\u7F16\u8BD1\u7684lsof |grep deleted\u67E5\u770B\u54EA\u4E9B\u88AB\u5220\u9664 COMMAND PID USER FD TYPE DEVICE SIZE NODE NAME gpm 1650 root 1u REG 8,2 5 149743 /var/run/gpm208raa (deleted)</p><p>4.\u5F97\u5230\u6587\u4EF6inode\u53F7\uFF0C\u8FD9\u91CC\u662F149743 5.\u4F7F\u7528sleuthkit\u5DE5\u5177\u6765\u6062\u590D\uFF0C df /var\u5F97\u51FA\u786C\u76D8\u4F4D\u7F6E\u662Fsda1 icat /dev/sda1 149743 6.\u628A\u6062\u590D\u7684\u6587\u4EF6\u4ED4\u7EC6\u67E5\u770B\uFF0C\u4E00\u822C\u90FD\u53EF\u4EE5\u627E\u5230\u75D5\u8FF9\u4E86</p><p>\u8FD9\u6837\u4F1A\u4F7F\u5206\u6790\u7F16\u8BD1\u540E\u7684\u7A0B\u5E8F\u56F0\u96BE gcc -04 -evil.c -o evil strip ./evil</p><p>1.file\u67E5\u770B\u6587\u4EF6\u7C7B\u578B\uFF0C\u662F\u5426\u9759\u6001\u7F16\u8BD1\u3001\u662F\u5426strip\u8FC7 2.strings\u663E\u793A\u7A0B\u5E8F\u4E2D\u7684asicc\u5B57\u7B26\u4E32,\u901A\u8FC7\u5B57\u7B26\u4E32\u518D\u5230google\u4E0A\u627E 3.strace\u662F\u8DDF\u8E2A\u7CFB\u7EDF\u8C03\u7528\uFF08\u8FD9\u4E2A\u8FD8\u4E0D\u77E5\u9053\u600E\u4E48\u6837\u7528\uFF09strace -p pid 4.gdb\uFF08\u66F4\u4E0D\u4F1A\u7528\u5566\uFF09</p><p>13\u6709\u4E9B\u8FDB\u7A0B\u4E0D\u5728\u8FDB\u7A0B\u91CC\u663E\u793A\uFF0C\u4F46\u5728/proc\u4E2D\u6709\u75D5\u8FF9\uFF0C\u53EF\u6BD4\u8F83\u627E\u51FA\u9690\u85CF\u7684\u8FDB\u7A0B proc\u662F\u4F2A\u6587\u4EF6\u7CFB\u7EDF\uFF0C\u4E3A/dev/kmem\u63D0\u4F9B\u4E00\u4E2A\u7ED3\u6784\u5316\u7684\u63A5\u53E3\uFF0C\u4FBF\u4E8E\u7CFB\u7EDF\u8BCA\u65AD\u5E76\u67E5\u770B\u6BCF\u4E00\u4E2A\u6B63\u5728\u8FD0\u884C\u7684\u53EF\u6267\u884C\u6587\u4EF6\u7684\u73AF\u5883 #ps -ef|awk \u2018{print $2}\u2019|sort -n|uniq &gt;1 #ls /porc |sort -n|uniq &gt;2 #diff 1 2</p><p>14\u5E94\u6025\u5DE5\u5177tct\uFF0C\u91CC\u9762\u6709\u8BB8\u591A\u4F7F\u7528\u5DE5\u5177\uFF0C\u5305\u62ECicat\u7B49\u6570\u636E\u6062\u590D \u5982\u679C\u5728\u88AB\u653B\u51FB\u7684\u673A\u5668\u53D6\u8BC1\uFF0C\u53EF\u4EE5mount\u4E00\u5757\u786C\u76D8\uFF0C\u4E5F\u53EF\u4EE5\u5907\u4EFD\u5230\u7F51\u7EDC\u4E2D\uFF0C\u65B9\u6CD5\uFF1A a.\u5728\u7F51\u7EDC\u673A\u5668\u8FD0\u884C nc -L -p 1234 &gt;abc.img b.\u8089\u9E21\u8FD0\u884C dd if=/dev/hdb5 count 20000 bs=1024|nc 192.168.0.1 1234 -w 3 \u5982\u679C\u5907\u4EFD\u8FC7\u5927\uFF0C\u5219\u53EF\u4EE5\u4FA6\u542C\u591A\u4E2A\u7AEF\u53E3\uFF0C\u6267\u884C\u591A\u4E2Add\u62F7\u8D1D\uFF0C\u7136\u540E\u628A\u6587\u4EF6\u5408\u5E76 cat 2 &gt;&gt;1.img</p><p>15 ldd\u53EF\u4EE5\u663E\u793A\u4E00\u4E2A\u53EF\u6267\u884C\u7A0B\u5E8F\u6240\u4F9D\u8D56\u7684\u52A8\u6001\u5E93,\u4F46\u95F4\u63A5\u4F9D\u8D56\u5E93\u65E0\u6CD5\u663E\u793A\u51FA\u6765 [root@rh9bk root]# ldd /bin/ls libtermcap.so.2 =&gt; /lib/libtermcap.so.2 (0\xD740022000) libc.so.6 =&gt; /lib/tls/libc.so.6 (0\xD742000000) /lib/ld-linux.so.2 =&gt; /lib/ld-linux.so.2 (0\xD740000000) strace\u5DE5\u5177\u662F\u4E00\u4E2A\u8C03\u8BD5\u5DE5\u5177\uFF0C\u5B83\u53EF\u4EE5\u663E\u793A\u51FA\u4E00\u4E2A\u7A0B\u5E8F\u5728\u6267\u884C\u8FC7\u7A0B\u4E2D\u7684\u6240\u6709\u7CFB\u7EDF\u8C03\u7528\uFF0C [root@rh9bk root]# strace -eopen /bin/ls &gt;/dev/null open(\u201C/etc/ld.so.preload\u201D, O_RDONLY) = -1 ENOENT (No such file or directory) open(\u201C/etc/ld.so.cache\u201D, O_RDONLY) = 3 open(\u201C/lib/libtermcap.so.2\u2033, O_RDONLY) = 3 open(\u201C/lib/tls/libc.so.6\u2033, O_RDONLY) = 3 open(\u201C/usr/lib/locale/locale-archive\u201D, O_RDONLY|O_LARGEFILE) = 3 open(\u201C.\u201D, O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY) = 3 open(\u201C/etc/mtab\u201D, O_RDONLY) = 3 open(\u201C/proc/meminfo\u201D, O_RDONLY) = 3</p><p>strace -o out telnet 192.168.100.100 o\u53C2\u6570\u7684\u542B\u4E49\u662F\u5C06strace\u7684\u8F93\u51FA\u4FE1\u606F\u751F\u6210\u5230out\u6587\u4EF6\u4E2D\uFF0C\u8FD9\u4E2A\u6587\u4EF6\u540D\u662F\u53EF\u4EE5\u968F\u610F\u5236\u5B9A\u7684\u3002 \u6211\u4EEC\u6253\u5F00out\u6587\u4EF6\u4F1A\u53D1\u73B0\u5927\u91CF\u7684\u7CFB\u7EDF\u8C03\u7528\u4FE1\u606F\uFF0C\u6211\u4EEC\u5173\u5FC3\u7684\u4E3B\u8981\u662Fopen\u8FD9\u4E2A\u7CFB\u7EDF\u8C03\u7528\u7684\u4FE1\u606F\uFF0Copen\u662F\u7528\u6765\u6253\u5F00\u6587\u4EF6\u7684\uFF0C\u4E0D\u4EC5\u8C03\u7528\u52A8\u6001\u5E93\u8981\u5148\u7528open\u6253\u5F00\uFF0C\u8BFB\u53D6\u914D\u7F6E\u6587\u4EF6\u4E5F\u4F7F\u7528open\uFF0C\u6240\u4EE5\u7528sed\u5199\u4E00\u4E2A\u7B80\u5355\u7684\u811A\u672C\u5C31\u53EF\u4EE5\u8F93\u51FAout\u6587\u4EF6\u4E2D\u6240\u6709\u7684open\u4FE1\u606F sed -n -e \u2018/^open/p\u2019 out \u8F93\u51FA\u4FE1\u606F\u5982\u4E0B\uFF1A open(\u201C/etc/ld.so.preload\u201D, O_RDONLY) = -1 ENOENT (No such file or directory) open(\u201C/etc/ld.so.cache\u201D, O_RDONLY) = 3 open(\u201C/lib/libutil.so.1\u2033, O_RDONLY) = 3 open(\u201C/usr/lib/libncurses.so.5\u2033, O_RDONLY) = 3 open(\u201C/lib/i686/libc.so.6\u2033, O_RDONLY) = 3 open(\u201C/etc/resolv.conf\u201D, O_RDONLY) = 3 open(\u201C/etc/nsswitch.conf\u201D, O_RDONLY) = 3 open(\u201C/etc/ld.so.cache\u201D, O_RDONLY) = 3 open(\u201C/lib/libnss_files.so.2\u2033, O_RDONLY) = 3 open(\u201C/etc/services\u201D, O_RDONLY) = 3 open(\u201C/etc/host.conf\u201D, O_RDONLY) = 3 open(\u201C/etc/hosts\u201D, O_RDONLY) = 3 open(\u201C/etc/ld.so.cache\u201D, O_RDONLY) = 3 open(\u201C/lib/libnss_nisplus.so.2\u2033, O_RDONLY) = 3 open(\u201C/lib/libnsl.so.1\u2033, O_RDONLY) = 3 open(\u201C/var/nis/NIS_COLD_START\u201D, O_RDONLY) = -1 ENOENT (No such file or directory) open(\u201C/etc/ld.so.cache\u201D, O_RDONLY) = 3 open(\u201C/lib/libnss_dns.so.2\u2033, O_RDONLY) = 3 open(\u201C/lib/libresolv.so.2\u2033, O_RDONLY) = 3 open(\u201C/etc/services\u201D, O_RDONLY) = 3 open(\u201C/root/.telnetrc\u201D, O_RDONLY) = -1 ENOENT (No such file or directory) open(\u201C/usr/share/terminfo/l/linux\u201D, O_RDONLY) = 4 \u4ECE\u8F93\u51FA\u4E2D\u53EF\u4EE5\u53D1\u73B0ldd\u663E\u793A\u4E0D\u51FA\u6765\u7684\u51E0\u4E2A\u5E93 /lib/libnss_dns.so.2 \uFF0C /lib/libresolv.so.2 \uFF0C /lib/libnsl.so.1\uFF0C /lib/libnss_nisplus.so.2\uFF0C /lib/libnss_files.so.2</p><p>strace -o aa -ff -p PID\u4F1A\u4EA7\u751Faa\u540D\u79F0\u5F00\u5934\u7684\u591A\u4E2A\u6587\u4EF6</p><p>grep open aa* | grep -v -e No -e null -e denied| grep WR \u67E5\u770B\u5176\u6253\u5F00\u8C03\u7528\u7684\u6587\u4EF6\u4FE1\u606F\u3002</p><p>16 \u8981\u628A\u65E5\u5FD7\u53D1\u9001\u5230\u65E5\u5FD7\u4E3B\u673A\u6B65\u9AA4: a.vi /etc/syslog.conf <em>.</em> @192.168.20.163 \u628A\u6240\u6709\u65E5\u5FD7\u53D1\u9001\u5230192.168.20.163 b.service syslog restart c.\u5728192.168.20.163\u5B89\u88C5kiwisyslogd d.\u8FDC\u7A0B\u767B\u9646,\u6545\u610F\u8F93\u5165\u9519\u8BEF\u5BC6\u7801,\u53EF\u770B\u5230\u65E5\u5FD7\u4E3B\u673A\u4E0A\u9A6C\u4E0A\u6709\u62A5\u8B66,\u4E5F\u53EF\u4EE5tcpdump port 514\u89C2\u5BDF</p><p>17 \u5982\u679C\u77E5\u9053\u9ED1\u5BA2\u662F0927\u5165\u4FB5\u7684\uFF0C\u5219\uFF1A touch -t 09270000 /tmp/a find / ( -newer /tmp/a -o -cnewer /tmp/a ) -l \u8FD9\u6837\u90A3\u5929\u6539\u53D8\u548C\u521B\u5EFA\u7684\u6587\u4EF6\u88AB\u5217\u51FA</p><p>18 \u6574\u76D8\u590D\u5236 dd if=/dev/sda of=/dev/sdb bs=1024 \u5206\u533A\u590D\u5236 \u6D4B\u8BD5\u8FC7 dd if=/dev/sda1 of=/abc bs=1024 \u8FD9\u91CC\u662F\u4FDD\u5B58\u5728\u4E86\u6839\u5206\u533A\uFF0C\u7528mount\u67E5\u770B\u662Fsda2 \u542F\u52A8\u53E6\u4E00\u4E2Alinux \u8F93\u5165\uFF1Amount /dev/sda2 /mnt \u8FD9\u91CC\u53EF\u4EE5\u770B\u5230\u521A\u624D\u7684abc\u6587\u4EF6\uFF0C\u8F93\u5165\uFF1Amount aa /tmp -o loop \u8FD9\u91CC\u770B\u5230\u5C31\u662F\u521A\u624D\u955C\u50CF\u7684\u6587\u4EF6\u5185\u5BB9</p><p>#19 find #\u67E5\u627E\u6307\u5B9A\u5B57\u7B26\u7684\u6587\u4EF6\uFF08\u6D4B\u8BD5\u53D1\u73B0\u4E8C\u8FDB\u5236\u4E5F\u53EF\u4EE5\u53D1\u73B0\uFF0C\u662Fstrings\u540E\u7684\u5185\u5BB9\uFF09 find /tmp -type f -exec grep \u201Cno exist\u201D {} ; -print find /etc/rc.d -name \u2018<em>crond\u2019 -exec file {} ; ##\u5339\u914D\u5B57\u7B26\u4E32\uFF0C\u627E\u51FA\u5B58\u5728\u5B57\u7B26\u4E32\u6587\u4EF6 find /data -name &quot;</em>.php&quot; -type f -print0|xargs -0 egrep &quot;(phpspy|c99sh|milw0rm|eval(base64_decode|spider_bc)&quot;|awk -F: &#39;{print $1}&#39;|sort|uniq find /data -name &quot;<em>.php&quot; -type f -print0|xargs -0 egrep &quot;aaa&quot;|awk -F: &#39;{print $1}&#39;|sort|uniq find . -name &quot;</em>.php&quot; -type f -print0| xargs -0 egrep &quot;aaa|bbb&quot;| egrep &quot;aaa&quot;</p><p>##\u9996\u5148\u786E\u5B9A\u9ED1\u5BA2IP\uFF0C\u7136\u540E\u901A\u8FC7find\u547D\u4EE4\u68C0\u67E5\u65E5\u5FD7\u6587\u4EF6\u4E2D\uFF0C\u542B\u6709\u9ED1IP\u7684\u65E5\u5FD7\uFF0C\u4ECE\u800C\u6392\u67E5\u7A0B\u5E8F\u6F0F\u6D1E\u70B9\uFF01</p><p>##\u67E5\u627E/etc/rc.d\u76EE\u5F55\u4E0B\u9762\u6240\u6709\u4EE5crond\u7ED3\u675F\u7684\u6587\u4EF6\uFF0C\u5E76\u4F7F\u7528file\u6307\u4EE4\u67E5\u770B\u5176\u5C5E\u6027\uFF0C\u6CE8\u610F\uFF1Aexec\u548Cfile\u95F4\u662F\u4E00\u4E2A\u7A7A\u683C\uFF0Cfile\u548C{}\u95F4\u662F\u4E00\u4E2A\u7A7A\u683C\uFF0Cfile\u548C;\u4E4B\u95F4\u662F\u4E00\u4E2A\u7A7A\u683C\uFF0C;\u662F\u4E00\u4E2A\u6574\u4F53\u3002</p><p>#20 #kill -SIGSEGV \u8FDB\u7A0B\u53F7 #\u4F1A\u4EA7\u751F\u4E00\u4E2Acore\u6587\u4EF6\uFF0C\u7528strings\u53EF\u4EE5\u770B\u4FE1\u606F\uFF0C\u7528\u4E00\u4E2Ac\u7A0B\u5E8F\u53EF\u4EE5\u91CD\u65B0\u6784\u5EFA\u5B83\u7684\u53EF\u6267\u884C\u7A0B\u5E8F\uFF0Cstudy/unix/\u4E0B\u4FDD\u5B58\u4E00\u4E2A\u6587\u7AE0\u3002\u6D4B\u8BD5\u6CA1\u4EA7\u751Fcore\uFF0C\u539F\u56E0\u4E0D\u8BE6\u3002</p><p>##\u5F53\u524D\u76EE\u524D(\u53CA\u5B50\u76EE\u5F55)\u4E0B\uFF0C\u6240\u6709\u7684log\u6587\u4EF6\u4E2D\u641C\u7D22\u5B57\u7B26\u4E32hacked by: find . -name &quot;*.log&quot; | xargs fgrep &quot;hacked by&quot;</p>",25),i=[r];function l(n,d){return o(),t("div",null,i)}const a=e(p,[["render",l],["__file","linux-sec.html.vue"]]);export{a as default};
