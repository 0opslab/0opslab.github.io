import{_ as n,o as s,c as a,e}from"./app.a667bd71.js";const i={},l=e(`<h3 id="\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#\u9009\u9879" aria-hidden="true">#</a> \u9009\u9879</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token parameter variable">-a</span> \u5C1D\u8BD5\u5C06\u7F51\u7EDC\u548C\u5E7F\u64AD\u5730\u5740\u8F6C\u6362\u6210\u540D\u79F0\u3002
-c<span class="token operator">&lt;</span>\u6570\u636E\u5305\u6570\u76EE<span class="token operator">&gt;</span> \u6536\u5230\u6307\u5B9A\u7684\u6570\u636E\u5305\u6570\u76EE\u540E\uFF0C\u5C31\u505C\u6B62\u8FDB\u884C\u503E\u5012\u64CD\u4F5C\u3002
<span class="token parameter variable">-d</span> \u628A\u7F16\u8BD1\u8FC7\u7684\u6570\u636E\u5305\u7F16\u7801\u8F6C\u6362\u6210\u53EF\u9605\u8BFB\u7684\u683C\u5F0F\uFF0C\u5E76\u503E\u5012\u5230\u6807\u51C6\u8F93\u51FA\u3002
<span class="token parameter variable">-dd</span> \u628A\u7F16\u8BD1\u8FC7\u7684\u6570\u636E\u5305\u7F16\u7801\u8F6C\u6362\u6210C\u8BED\u8A00\u7684\u683C\u5F0F\uFF0C\u5E76\u503E\u5012\u5230\u6807\u51C6\u8F93\u51FA\u3002
<span class="token parameter variable">-ddd</span> \u628A\u7F16\u8BD1\u8FC7\u7684\u6570\u636E\u5305\u7F16\u7801\u8F6C\u6362\u6210\u5341\u8FDB\u5236\u6570\u5B57\u7684\u683C\u5F0F\uFF0C\u5E76\u503E\u5012\u5230\u6807\u51C6\u8F93\u51FA\u3002
<span class="token parameter variable">-e</span> \u5728\u6BCF\u5217\u503E\u5012\u8D44\u6599\u4E0A\u663E\u793A\u8FDE\u63A5\u5C42\u7EA7\u7684\u6587\u4EF6\u5934\u3002
<span class="token parameter variable">-f</span> \u7528\u6570\u5B57\u663E\u793A\u7F51\u9645\u7F51\u7EDC\u5730\u5740\u3002
-F<span class="token operator">&lt;</span>\u8868\u8FBE\u6587\u4EF6<span class="token operator">&gt;</span> \u6307\u5B9A\u5185\u542B\u8868\u8FBE\u65B9\u5F0F\u7684\u6587\u4EF6\u3002
-i<span class="token operator">&lt;</span>\u7F51\u7EDC\u754C\u9762<span class="token operator">&gt;</span> \u4F7F\u7528\u6307\u5B9A\u7684\u7F51\u7EDC\u622A\u9762\u9001\u51FA\u6570\u636E\u5305\u3002
<span class="token parameter variable">-l</span> \u4F7F\u7528\u6807\u51C6\u8F93\u51FA\u5217\u7684\u7F13\u51B2\u533A\u3002
<span class="token parameter variable">-n</span> \u4E0D\u628A\u4E3B\u673A\u7684\u7F51\u7EDC\u5730\u5740\u8F6C\u6362\u6210\u540D\u5B57\u3002
<span class="token parameter variable">-N</span> \u4E0D\u5217\u51FA\u57DF\u540D\u3002
<span class="token parameter variable">-O</span> \u4E0D\u5C06\u6570\u636E\u5305\u7F16\u7801\u6700\u4F73\u5316\u3002
<span class="token parameter variable">-p</span> \u4E0D\u8BA9\u7F51\u7EDC\u754C\u9762\u8FDB\u5165\u6DF7\u6742\u6A21\u5F0F\u3002
<span class="token parameter variable">-q</span> \u5FEB\u901F\u8F93\u51FA\uFF0C\u4EC5\u5217\u51FA\u5C11\u6570\u7684\u4F20\u8F93\u534F\u8BAE\u4FE1\u606F\u3002
-r<span class="token operator">&lt;</span>\u6570\u636E\u5305\u6587\u4EF6<span class="token operator">&gt;</span> \u4ECE\u6307\u5B9A\u7684\u6587\u4EF6\u8BFB\u53D6\u6570\u636E\u5305\u6570\u636E\u3002
-s<span class="token operator">&lt;</span>\u6570\u636E\u5305\u5927\u5C0F<span class="token operator">&gt;</span> \u8BBE\u7F6E\u6BCF\u4E2A\u6570\u636E\u5305\u7684\u5927\u5C0F\u3002
<span class="token parameter variable">-S</span> \u7528\u7EDD\u5BF9\u800C\u975E\u76F8\u5BF9\u6570\u503C\u5217\u51FATCP\u5173\u8054\u6570\u3002
<span class="token parameter variable">-t</span> \u5728\u6BCF\u5217\u503E\u5012\u8D44\u6599\u4E0A\u4E0D\u663E\u793A\u65F6\u95F4\u6233\u8BB0\u3002
<span class="token parameter variable">-tt</span> \u5728\u6BCF\u5217\u503E\u5012\u8D44\u6599\u4E0A\u663E\u793A\u672A\u7ECF\u683C\u5F0F\u5316\u7684\u65F6\u95F4\u6233\u8BB0\u3002
-T<span class="token operator">&lt;</span>\u6570\u636E\u5305\u7C7B\u578B<span class="token operator">&gt;</span> \u5F3A\u5236\u5C06\u8868\u8FBE\u65B9\u5F0F\u6240\u6307\u5B9A\u7684\u6570\u636E\u5305\u8F6C\u8BD1\u6210\u8BBE\u7F6E\u7684\u6570\u636E\u5305\u7C7B\u578B\u3002
<span class="token parameter variable">-v</span> \u8BE6\u7EC6\u663E\u793A\u6307\u4EE4\u6267\u884C\u8FC7\u7A0B\u3002
<span class="token parameter variable">-vv</span> \u66F4\u8BE6\u7EC6\u663E\u793A\u6307\u4EE4\u6267\u884C\u8FC7\u7A0B\u3002
<span class="token parameter variable">-x</span> \u7528\u5341\u516D\u8FDB\u5236\u5B57\u7801\u5217\u51FA\u6570\u636E\u5305\u8D44\u6599\u3002
-w<span class="token operator">&lt;</span>\u6570\u636E\u5305\u6587\u4EF6<span class="token operator">&gt;</span> \u628A\u6570\u636E\u5305\u6570\u636E\u5199\u5165\u6307\u5B9A\u7684\u6587\u4EF6\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5E38\u7528\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a> \u5E38\u7528\u547D\u4EE4</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># TCPDump is a packet analyzer. It allows the user to intercept and display TCP/IP</span>
<span class="token comment">#TCPDump\u662F\u4E00\u4E2A\u6570\u636E\u5305\u5206\u6790\u5668\u3002\u5B83\u5141\u8BB8\u7528\u6237\u62E6\u622A\u548C\u663E\u793ATCP / IP</span>
<span class="token comment"># and other packets being transmitted or received over a network. (cf Wikipedia).</span>
<span class="token comment">#\u548C\u5176\u4ED6\u6570\u636E\u5305\u901A\u8FC7\u7F51\u7EDC\u4F20\u8F93\u6216\u63A5\u6536\u3002 \uFF08\u6BD4\u8F83\u7EF4\u57FA\u767E\u79D1\uFF09\u3002</span>
<span class="token comment"># Note: 173.194.40.120 =&gt; google.com</span>
<span class="token comment">#\u6CE8\u610F\uFF1A173.194.40.120 =&gt; google.com</span>

<span class="token comment"># Intercepts all packets on eth0</span>
<span class="token comment">#\u62E6\u622Aeth0\u4E0A\u7684\u6240\u6709\u6570\u636E\u5305</span>
tcpdump <span class="token parameter variable">-i</span> eth0

<span class="token comment"># Intercepts all packets from/to 173.194.40.120</span>
<span class="token comment">#\u62E6\u622A\u6765\u81EA/\u5230173.194.40.120\u7684\u6240\u6709\u6570\u636E\u5305</span>
tcpdump <span class="token function">host</span> <span class="token number">173.194</span>.40.120

<span class="token comment"># Intercepts all packets on all interfaces from / to 173.194.40.120 port 80</span>
<span class="token comment">#\u62E6\u622A\u6765\u81EA/\u5230173.194.40.120\u7AEF\u53E380\u7684\u6240\u6709\u63A5\u53E3\u4E0A\u7684\u6240\u6709\u6570\u636E\u5305</span>
<span class="token comment"># -nn =&gt; Disables name resolution for IP addresses and port numbers.</span>
<span class="token comment">#-nn =&gt;\u7981\u7528IP\u5730\u5740\u548C\u7AEF\u53E3\u53F7\u7684\u540D\u79F0\u89E3\u6790\u3002</span>
tcpdump <span class="token parameter variable">-nn</span> <span class="token parameter variable">-i</span> any <span class="token function">host</span> <span class="token number">173.194</span>.40.120 and port <span class="token number">80</span>

<span class="token comment"># Make a grep on tcpdump (ASCII)</span>
<span class="token comment">#\u5728tcpdump\u4E0A\u521B\u5EFA\u4E00\u4E2Agrep\uFF08ASCII\uFF09</span>
<span class="token comment"># -A  =&gt; Show only ASCII in packets.</span>
<span class="token comment">#-A =&gt;\u4EC5\u663E\u793A\u6570\u636E\u5305\u4E2D\u7684ASCII\u3002</span>
<span class="token comment"># -s0 =&gt; By default, tcpdump only captures 68 bytes.</span>
<span class="token comment">#-s0 =&gt;\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Ctcpdump\u4EC5\u6355\u83B768\u4E2A\u5B57\u8282\u3002</span>
tcpdump <span class="token parameter variable">-i</span> <span class="token parameter variable">-A</span> any <span class="token function">host</span> <span class="token number">173.194</span>.40.120 and port <span class="token number">80</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;User-Agent&#39;</span>

<span class="token comment"># With ngrep</span>
<span class="token comment">#\u4F7F\u7528ngrep</span>
<span class="token comment"># -d eth0 =&gt; To force eth0 (else ngrep work on all interfaces)</span>
<span class="token comment">#-d eth0 =&gt;\u5F3A\u5236eth0\uFF08\u5426\u5219ngrep\u9002\u7528\u4E8E\u6240\u6709\u63A5\u53E3\uFF09</span>
<span class="token comment"># -s0 =&gt; force ngrep to look at the entire packet. (Default snaplen: 65536 bytes)</span>
<span class="token comment">#-s0 =&gt;\u5F3A\u5236ngrep\u67E5\u770B\u6574\u4E2A\u6570\u636E\u5305\u3002 \uFF08\u9ED8\u8BA4snaplen\uFF1A65536\u5B57\u8282\uFF09</span>
ngrep <span class="token string">&#39;User-Agent&#39;</span> <span class="token function">host</span> <span class="token number">173.194</span>.40.120 and port <span class="token number">80</span>

<span class="token comment"># Intercepts all packets on all interfaces from / to 8.8.8.8 or 173.194.40.127 on port 80</span>
<span class="token comment">#\u62E6\u622A\u7AEF\u53E380\u4E0A\u6240\u6709\u63A5\u53E3\u4E0A\u7684\u6240\u6709\u6570\u636E\u5305/ 8.8.8.8\u6216173.194.40.127</span>
tcpdump <span class="token string">&#39;host ( 8.8.8.8 or 173.194.40.127 ) and port 80&#39;</span> <span class="token parameter variable">-i</span> any

<span class="token comment"># Intercepts all packets SYN and FIN of each TCP session.</span>
<span class="token comment">#\u622A\u83B7\u6BCF\u4E2ATCP\u4F1A\u8BDD\u7684\u6240\u6709\u6570\u636E\u5305SYN\u548CFIN\u3002</span>
tcpdump <span class="token string">&#39;tcp[tcpflags] &amp; (tcp-syn|tcp-fin) != 0&#39;</span>

<span class="token comment"># To display SYN and FIN packets of each TCP session to a host that is not on our network</span>
<span class="token comment">#\u5C06\u6BCF\u4E2ATCP\u4F1A\u8BDD\u7684SYN\u548CFIN\u6570\u636E\u5305\u663E\u793A\u7ED9\u4E0D\u5728\u6211\u4EEC\u7F51\u7EDC\u4E0A\u7684\u4E3B\u673A</span>
tcpdump <span class="token string">&#39;tcp[tcpflags] &amp; (tcp-syn|tcp-fin) != 0 and not src and dst net local_addr&#39;</span>

<span class="token comment"># To display all IPv4 HTTP packets that come or arrive on port 80 and that contain only data (no SYN, FIN no, no packet containing an ACK)</span>
<span class="token comment">#\u663E\u793A\u5230\u8FBE\u6216\u5230\u8FBE\u7AEF\u53E380\u5E76\u4E14\u4EC5\u5305\u542B\u6570\u636E\u7684\u6240\u6709IPv4 HTTP\u6570\u636E\u5305\uFF08\u6CA1\u6709SYN\uFF0CFIN no\uFF0C\u6CA1\u6709\u5305\u542BACK\u7684\u6570\u636E\u5305\uFF09</span>
tcpdump <span class="token string">&#39;tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)&#39;</span>

<span class="token comment"># Saving captured data</span>
<span class="token comment">#\u4FDD\u5B58\u6355\u83B7\u7684\u6570\u636E</span>
tcpdump <span class="token parameter variable">-w</span> file.cap

<span class="token comment"># Reading from capture file</span>
<span class="token comment">#\u4ECE\u6355\u83B7\u6587\u4EF6\u4E2D\u8BFB\u53D6</span>
tcpdump <span class="token parameter variable">-r</span> file.cap

<span class="token comment"># Show content in hexa</span>
<span class="token comment">#\u4EE5hexa\u663E\u793A\u5185\u5BB9</span>
<span class="token comment"># Change -x to -xx =&gt; show extra header (ethernet).</span>
<span class="token comment">#\u5C06-x\u66F4\u6539\u4E3A-xx =&gt;\u663E\u793A\u989D\u5916\u6807\u5934\uFF08\u4EE5\u592A\u7F51\uFF09\u3002</span>
tcpdump <span class="token parameter variable">-x</span>

<span class="token comment"># Show content in hexa and ASCII</span>
<span class="token comment">#\u4EE5\u5341\u516D\u8FDB\u5236\u548CASCII\u663E\u793A\u5185\u5BB9</span>
<span class="token comment"># Change -X to -XX =&gt; show extra header (ethernet).</span>
<span class="token comment">#\u5C06-X\u66F4\u6539\u4E3A-XX =&gt;\u663E\u793A\u989D\u5916\u6807\u5934\uFF08\u4EE5\u592A\u7F51\uFF09\u3002</span>
tcpdump <span class="token parameter variable">-X</span>

<span class="token comment"># Note on packet maching:</span>
<span class="token comment">#\u5305\u673A\u6CE8\u610F\u4E8B\u9879\uFF1A</span>
<span class="token comment"># Port matching:</span>
<span class="token comment">#\u7AEF\u53E3\u5339\u914D\uFF1A</span>
<span class="token comment"># - portrange 22-23</span>
<span class="token comment"># -  portrange 22-23</span>
<span class="token comment"># - not port 22</span>
<span class="token comment"># - \u4E0D\u662F22\u53F7\u6E2F\u53E3</span>
<span class="token comment"># - port ssh</span>
<span class="token comment"># - \u7AEF\u53E3ssh</span>
<span class="token comment"># - dst port 22</span>
<span class="token comment"># - \u7B49\u7AEF\u53E322</span>
<span class="token comment"># - src port 22</span>
<span class="token comment"># -  src\u7AEF\u53E322</span>
<span class="token comment">#</span>
<span class="token comment">##</span>
<span class="token comment"># Host matching:</span>
<span class="token comment">#\u4E3B\u673A\u5339\u914D\uFF1A</span>
<span class="token comment"># - dst host 8.8.8.8</span>
<span class="token comment"># -  dst\u4E3B\u673A8.8.8.8</span>
<span class="token comment"># - not dst host 8.8.8.8</span>
<span class="token comment"># - \u4E0D\u662F\u4E3B\u6301\u4EBA8.8.8.8</span>
<span class="token comment"># - src net 67.207.148.0 mask 255.255.255.0</span>
<span class="token comment"># -  src net 67.207.148.0 mask 255.255.255.0</span>
<span class="token comment"># - src net 67.207.148.0/24</span>
<span class="token comment"># -  src net 67.207.148.0/24</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),t=[l];function c(p,r){return s(),a("div",null,t)}const m=n(i,[["render",c],["__file","tcpdump.html.vue"]]);export{m as default};
