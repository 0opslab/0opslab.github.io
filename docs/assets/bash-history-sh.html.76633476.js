import{_ as s,o as n,c as a,e as t}from"./app.a667bd71.js";const e={},o=t(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#\`\`\`ops</span>
<span class="token comment">#title:\u901A\u8FC7\u811A\u672C\u5B8C\u6210\u4E00\u4E9Bhistory\u76F8\u5173\u7684\u64CD\u4F5C</span>
<span class="token comment">#descr:</span>
<span class="token comment">#\`\`\`</span>

<span class="token comment">### \u8BBE\u7F6E\u4FDD\u5B58\u5386\u53F2\u547D\u4EE4\u7684\u6587\u4EF6\u5927\u5C0F</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">HISTFILESIZE</span></span><span class="token operator">=</span><span class="token number">10000000</span>
<span class="token comment">### \u4FDD\u5B58\u5386\u53F2\u547D\u4EE4\u6761\u6570</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">HISTSIZE</span></span><span class="token operator">=</span><span class="token number">1000000</span>
<span class="token comment">### \u5B9E\u65F6\u8BB0\u5F55\u5386\u53F2\u547D\u4EE4\uFF0C\u9ED8\u8BA4\u53EA\u6709\u5728\u7528\u6237\u9000\u51FA\u4E4B\u540E\u624D\u4F1A\u7EDF\u4E00\u8BB0\u5F55\uFF0C\u5F88\u5BB9\u6613\u9020\u6210\u591A\u4E2A\u7528\u6237\u95F4\u7684\u76F8\u4E92\u8986\u76D6\u3002</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">PROMPT_COMMAND</span><span class="token operator">=</span><span class="token string">&quot;history -a&quot;</span>
<span class="token comment">### \u8BB0\u5F55\u6BCF\u6761\u5386\u53F2\u547D\u4EE4\u7684\u6267\u884C\u65F6\u95F4</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HISTTIMEFORMAT</span><span class="token operator">=</span><span class="token string">&quot;%Y-%m-%d_%H:%M:%S &quot;</span>

<span class="token comment">##\u8BB0\u5F55history\u5386\u53F2\u547D\u4EE4 \u65F6\u95F4 IP\u7B49</span>
<span class="token comment">##export HISTTIMEFORMAT=&quot;{\\&quot;TIME\\&quot;:\\&quot;%F %T\\&quot;,\\&quot;HOSTNAME\\&quot;:\\&quot;\\$HOSTNAME\\&quot;,\\&quot;LI\\&quot;:\\&quot;\\$(who -u am i 2&gt;/dev/null| awk &#39;{print \\$NF}&#39;|sed -e &#39;s/[()]//g&#39;)\\&quot;,\\&quot;LU\\&quot;:\\&quot;\\$(who am i|awk &#39;{print \\$1}&#39;)\\&quot;,\\&quot;NU\\&quot;:\\&quot;\\\${USER}\\&quot;,\\&quot;CMD\\&quot;:\\&quot;&quot;</span>
<span class="token function">cat</span> <span class="token operator">&gt;&gt;</span>/etc/bashrc<span class="token operator">&lt;&lt;</span><span class="token string">EOF
HISTDIR=&#39;/var/log/command.log&#39;
if [ ! -f \\<span class="token variable">$HISTDIR</span> ];then
touch \\<span class="token variable">$HISTDIR</span>
chmod 666 \\<span class="token variable">$HISTDIR</span>
fi
export HISTTIMEFORMAT=&quot;{<span class="token entity" title="\\&quot;">\\&quot;</span>TIME<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span>%F %T<span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token entity" title="\\&quot;">\\&quot;</span>IP<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span>\\<span class="token variable"><span class="token variable">$(</span><span class="token function">ip</span> a <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">&#39;192.168|172&#39;</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print$2}&#39;</span> <span class="token operator">|</span> <span class="token function">cut</span> -d/ <span class="token parameter variable">-f1</span><span class="token variable">)</span></span><span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token entity" title="\\&quot;">\\&quot;</span>LI<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span>\\$(who -u am i 2&gt;/dev/null| awk &#39;{print \\<span class="token variable">$NF</span>}&#39;|sed -e &#39;s/[()]//g&#39;)<span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token entity" title="\\&quot;">\\&quot;</span>LU<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span>\\<span class="token variable"><span class="token variable">$(</span><span class="token function">who</span> am i<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">&#39;{print \\$1}&#39;</span><span class="token variable">)</span></span><span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token entity" title="\\&quot;">\\&quot;</span>NU<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span>\\<span class="token variable">\${<span class="token environment constant">USER</span>}</span><span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token entity" title="\\&quot;">\\&quot;</span>CMD<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span>&quot; 
export PROMPT_COMMAND=&#39;history 1|tail -1|sed &quot;s/^[ ]\\+[0-9]\\+  //&quot;|sed &quot;s/$/<span class="token entity" title="\\&quot;">\\&quot;</span>}/&quot;&gt;&gt; /var/log/command.log&#39;
EOF</span>

<span class="token builtin class-name">source</span> /etc/bashrc
<span class="token builtin class-name">echo</span> OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),l=[o];function i(p,c){return n(),a("div",null,l)}const r=s(e,[["render",i],["__file","bash-history-sh.html.vue"]]);export{r as default};
