import{_ as n,o as s,c as a,e}from"./app.a667bd71.js";const p={},t=e(`<p>OpenResty\u5141\u8BB8\u5F00\u53D1\u4EBA\u5458\u4F7F\u7528lua\u7F16\u7A0B\u8BED\u8A00\u6784\u5EFA\u73B0\u6709\u7684Nginx\u7684C\u6A21\u5757\uFF0C\u652F\u6301\u9AD8\u6D41\u91CF\u7684\u5E94\u7528\u7A0B\u5E8F\u3002 OpenResty\u5B98\u7F51\uFF1Ahttps://openresty.org/cn/download.html</p><h5 id="\u5B89\u88C5\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5\u4F9D\u8D56" aria-hidden="true">#</a> \u5B89\u88C5\u4F9D\u8D56</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># yum install -y readline-devel pcre-devel openssl-devel perl gcc gcc-c++ libreadline-dev libncurses5-dev libpcre3-dev libssl-dev</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="\u7F16\u8BD1\u5B89\u88C5openresty" tabindex="-1"><a class="header-anchor" href="#\u7F16\u8BD1\u5B89\u88C5openresty" aria-hidden="true">#</a> \u7F16\u8BD1\u5B89\u88C5OpenResty</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost src<span class="token punctuation">]</span><span class="token comment"># tar zxvf openresty-1.11.2.5.tar.gz</span>
<span class="token punctuation">[</span>root@localhost src<span class="token punctuation">]</span><span class="token comment"># cd openresty-1.11.2.5</span>
<span class="token punctuation">[</span>root@localhost openresty-1.11.2.5<span class="token punctuation">]</span><span class="token comment"># groupadd www</span>
<span class="token punctuation">[</span>root@localhost openresty-1.11.2.5<span class="token punctuation">]</span><span class="token comment"># useradd -s /sbin/nologin -M -g www www</span>
<span class="token punctuation">[</span>root@localhost openresty-1.11.2.5<span class="token punctuation">]</span><span class="token comment"># ./configure --prefix=/app/OpenResty \\</span>
<span class="token operator">&gt;</span>--user<span class="token operator">=</span>www <span class="token punctuation">\\</span>
<span class="token operator">&gt;</span>--group<span class="token operator">=</span>www <span class="token punctuation">\\</span>
<span class="token operator">&gt;</span>--with-luajit <span class="token punctuation">\\</span>
<span class="token operator">&gt;</span>--without-http_redis2_module <span class="token punctuation">\\</span>       
<span class="token operator">&gt;</span>--with-http_iconv_module <span class="token punctuation">\\</span>
<span class="token operator">&gt;</span>--with-http_realip_module <span class="token punctuation">\\</span>       <span class="token comment">#\u83B7\u53D6\u7528\u6237\u771F\u5B9Eip\u6A21\u5757</span>
<span class="token operator">&gt;</span>--with-pcre <span class="token punctuation">\\</span>                     <span class="token comment">#Perl\u517C\u5BB9\u7684\u8FBE\u5F0F\u6A21\u5757</span>
<span class="token operator">&gt;</span>--with-luajit <span class="token punctuation">\\</span>                   <span class="token comment">#\u96C6\u6210luajit\u6A21\u5757</span>
<span class="token operator">&gt;</span>--add-module<span class="token operator">=</span>./bundle/ngx_cache_purge-2.3/ <span class="token punctuation">\\</span>                <span class="token comment">#\u6DFB\u52A0\u81EA\u5B9A\u4E49\u7684\u6A21\u5757</span>
<span class="token operator">&gt;</span>--add-module<span class="token operator">=</span>./bundle/nginx_upstream_check_module-0.3.0/ <span class="token punctuation">\\</span>
<span class="token operator">&gt;</span>-j2                       <span class="token comment">#\u652F\u6301\u591A\u6838 make \u5DE5\u4F5C\u7684\u7279\u6027,</span>
<span class="token punctuation">[</span>root@localhost openresty-1.11.2.5<span class="token punctuation">]</span><span class="token comment"># gmake &amp;&amp; gmake install</span>
<span class="token punctuation">[</span>root@localhost openresty-1.11.2.5<span class="token punctuation">]</span><span class="token comment"># cd /app/OpenResty/nginx/sbin/</span>
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ls</span>
nginx
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ./nginx -V</span>
nginx version: openresty/1.11.2.5
built by gcc <span class="token number">4.4</span>.7 <span class="token number">20120313</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.4</span>.7-18<span class="token punctuation">)</span> <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span> 
built with OpenSSL <span class="token number">1.0</span>.1e-fips <span class="token number">11</span> Feb <span class="token number">2013</span>
TLS SNI support enabled
configure arguments: <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/app/OpenResty/nginx --with-cc-opt<span class="token operator">=</span>-O2 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_devel_kit-0.3.0 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/echo-nginx-module-0.61 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/xss-nginx-module-0.05 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_coolkit-0.2rc3 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/set-misc-nginx-module-0.31 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/form-input-nginx-module-0.12 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/encrypted-session-nginx-module-0.06 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/srcache-nginx-module-0.31 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua-0.10.10 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua_upstream-0.07 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/headers-more-nginx-module-0.32 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/array-var-nginx-module-0.05 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/memc-nginx-module-0.18 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/redis2-nginx-module-0.14 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/redis-nginx-module-0.3.7 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-json-nginx-module-0.14 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-csv-nginx-module-0.07 --with-ld-opt<span class="token operator">=</span>-Wl,-rpath,/app/OpenResty/luajit/lib <span class="token parameter variable">--user</span><span class="token operator">=</span>www <span class="token parameter variable">--group</span><span class="token operator">=</span>www --with-http_realip_module --with-http_ssl_module
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ./nginx -v</span>
nginx version: openresty/1.11.2.5
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ./nginx -t</span>
nginx: the configuration <span class="token function">file</span> /app/OpenResty/nginx/conf/nginx.conf syntax is ok
nginx: configuration <span class="token function">file</span> /app/OpenResty/nginx/conf/nginx.conf <span class="token builtin class-name">test</span> is successful
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ./nginx -t -c /app/OpenResty/nginx/conf/nginx.conf</span>
nginx: the configuration <span class="token function">file</span> /app/OpenResty/nginx/conf/nginx.conf syntax is ok
nginx: configuration <span class="token function">file</span> /app/OpenResty/nginx/conf/nginx.conf <span class="token builtin class-name">test</span> is successful
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ./nginx </span>
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ps -ef|grep -i nginx</span>
root     <span class="token number">18014</span>     <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">10</span>:57 ?        00:00:00 nginx: master process ./nginx
www      <span class="token number">18015</span> <span class="token number">18014</span>  <span class="token number">0</span> <span class="token number">10</span>:57 ?        00:00:00 nginx: worker process
root     <span class="token number">18017</span>  <span class="token number">2603</span>  <span class="token number">0</span> <span class="token number">10</span>:57 pts/0    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">-i</span> nginx
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u914D\u7F6E\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u670D\u52A1" aria-hidden="true">#</a> \u914D\u7F6E\u670D\u52A1</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment"># cat /etc/init.d/nginx </span>
<span class="token comment">#!/bin/sh</span>
<span class="token comment">#</span>
<span class="token comment"># nginx - this script starts and stops the nginx daemon</span>
<span class="token comment">#</span>
<span class="token comment"># chkconfig: - 85 15</span>
<span class="token comment"># description: Nginx is an HTTP(S) server, HTTP(S) reverse \\</span>
<span class="token comment"># proxy and IMAP/POP3 proxy server</span>
<span class="token comment"># processname: nginx</span>
<span class="token comment"># config: /etc/nginx/nginx.conf</span>
<span class="token comment"># config: /app/nginx/conf/nginx.conf</span>
<span class="token comment"># pidfile: /app/nginx/logs/nginx.pid</span>
<span class="token comment"># Source function library.</span>
<span class="token builtin class-name">.</span> /etc/rc.d/init.d/functions
<span class="token comment"># Source networking configuration.</span>
<span class="token builtin class-name">.</span> /etc/sysconfig/network
<span class="token comment"># Check that networking is up.</span>
<span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$NETWORKING</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;no&quot;</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span>
<span class="token assign-left variable">NGINX_PATH</span><span class="token operator">=</span><span class="token string">&quot;/app/OpenResty/nginx&quot;</span>
<span class="token assign-left variable">nginx</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$NGINX_PATH</span>/sbin/nginx&quot;</span>
<span class="token assign-left variable">prog</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $nginx<span class="token variable">)</span></span>
<span class="token assign-left variable">NGINX_CONF_FILE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$NGINX_PATH</span>/conf/nginx.conf&quot;</span>
<span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /etc/sysconfig/nginx <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">.</span> /etc/sysconfig/nginx
<span class="token assign-left variable">lockfile</span><span class="token operator">=</span>/var/lock/subsys/nginx
<span class="token function-name function">make_dirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment"># make required directories</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span>$nginx <span class="token parameter variable">-V</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;configure arguments:&quot;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/[^*]*--user=\\([^ ]*\\).*/\\1/g&#39;</span> -<span class="token variable">\`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">\`</span><span class="token function">grep</span> $user /etc/passwd<span class="token variable">\`</span></span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token function">useradd</span> <span class="token parameter variable">-M</span> <span class="token parameter variable">-s</span> /bin/nologin <span class="token variable">$user</span>
<span class="token keyword">fi</span>
<span class="token assign-left variable">options</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span>$nginx <span class="token parameter variable">-V</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;configure arguments:&#39;</span><span class="token variable">\`</span></span>
<span class="token keyword">for</span> <span class="token for-or-select variable">opt</span> <span class="token keyword">in</span> <span class="token variable">$options</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">echo</span> $opt <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;.*-temp-path&#39;</span><span class="token variable">\`</span></span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token builtin class-name">echo</span> $opt <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;=&quot;</span> <span class="token parameter variable">-f</span> <span class="token number">2</span><span class="token variable">\`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$value</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token comment"># echo &quot;creating&quot; $value</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$value</span> <span class="token operator">&amp;&amp;</span> <span class="token function">chown</span> <span class="token parameter variable">-R</span> <span class="token variable">$user</span> <span class="token variable">$value</span>
<span class="token keyword">fi</span>
<span class="token keyword">fi</span>
<span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token function-name function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">[</span> <span class="token parameter variable">-x</span> <span class="token variable">$nginx</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">5</span>
<span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token variable">$NGINX_CONF_FILE</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">6</span>
make_dirs
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">&quot;Starting <span class="token variable">$prog</span>: &quot;</span>
daemon <span class="token variable">$nginx</span> <span class="token parameter variable">-c</span> <span class="token variable">$NGINX_CONF_FILE</span>
<span class="token assign-left variable">retval</span><span class="token operator">=</span><span class="token variable">$?</span>
<span class="token builtin class-name">echo</span>
<span class="token punctuation">[</span> <span class="token variable">$retval</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">touch</span> <span class="token variable">$lockfile</span>
<span class="token builtin class-name">return</span> <span class="token variable">$retval</span>
<span class="token punctuation">}</span>
<span class="token function-name function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">&quot;Stopping <span class="token variable">$prog</span>: &quot;</span>
killproc <span class="token variable">$prog</span> <span class="token parameter variable">-QUIT</span>
<span class="token assign-left variable">retval</span><span class="token operator">=</span><span class="token variable">$?</span>
<span class="token builtin class-name">echo</span>
<span class="token punctuation">[</span> <span class="token variable">$retval</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable">$lockfile</span>
<span class="token builtin class-name">return</span> <span class="token variable">$retval</span>
<span class="token punctuation">}</span>
<span class="token function-name function">restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">#configtest || return $?</span>
stop
<span class="token function">sleep</span> <span class="token number">1</span>
start
<span class="token punctuation">}</span>
<span class="token function-name function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">#configtest || return $?</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">&quot;Reloading <span class="token variable">$prog</span>: &quot;</span>
killproc <span class="token variable">$nginx</span> <span class="token parameter variable">-HUP</span>
<span class="token assign-left variable">RETVAL</span><span class="token operator">=</span><span class="token variable">$?</span>
<span class="token builtin class-name">echo</span>
<span class="token punctuation">}</span>
<span class="token function-name function">force_reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
restart
<span class="token punctuation">}</span>
<span class="token function-name function">configtest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token variable">$nginx</span> <span class="token parameter variable">-t</span> <span class="token parameter variable">-c</span> <span class="token variable">$NGINX_CONF_FILE</span>
<span class="token punctuation">}</span>
<span class="token function-name function">rh_status</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
status <span class="token variable">$prog</span>
<span class="token punctuation">}</span>
<span class="token function-name function">rh_status_q</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
rh_status <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
<span class="token punctuation">}</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token keyword">in</span>
start<span class="token punctuation">)</span>
rh_status_q <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span>
<span class="token variable">$1</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
stop<span class="token punctuation">)</span>
rh_status_q <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span>
<span class="token variable">$1</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
restart<span class="token operator">|</span>configtest<span class="token punctuation">)</span>
<span class="token variable">$1</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
reload<span class="token punctuation">)</span>
rh_status_q <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">7</span>
<span class="token variable">$1</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
force-reload<span class="token punctuation">)</span>
force_reload
<span class="token punctuation">;</span><span class="token punctuation">;</span>
status<span class="token punctuation">)</span>
rh_status
<span class="token punctuation">;</span><span class="token punctuation">;</span>
condrestart<span class="token operator">|</span>try-restart<span class="token punctuation">)</span>
rh_status_q <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
*<span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> $<span class="token string">&quot;Usage: <span class="token variable">$0</span> {start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest}&quot;</span>
<span class="token builtin class-name">exit</span> <span class="token number">2</span>
<span class="token keyword">esac</span>
<span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment"># chkconfig --add nginx</span>
<span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment"># chkconfig nginx on</span>
<span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment"># service nginx restart</span>
Stopping nginx:                                            <span class="token punctuation">[</span>  OK  <span class="token punctuation">]</span>
Starting nginx:                                            <span class="token punctuation">[</span>  OK  <span class="token punctuation">]</span>
<span class="token punctuation">[</span>root@localhost nginx<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="nginx\u5347\u7EA7" tabindex="-1"><a class="header-anchor" href="#nginx\u5347\u7EA7" aria-hidden="true">#</a> nginx\u5347\u7EA7</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u67E5\u770B\u539F\u6765\u7684\u53C2\u6570</span>
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/app/OpenResty2/nginx/sbin
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment"># ./nginx -V</span>
nginx version: web/999.999.9.1
built by gcc <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-28<span class="token punctuation">)</span> <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span>
built with OpenSSL <span class="token number">1.0</span>.2k-fips  <span class="token number">26</span> Jan <span class="token number">2017</span>
TLS SNI support enabled
configure arguments: <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/app/OpenResty2/nginx --with-cc-opt<span class="token operator">=</span>-O2 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_devel_kit-0.3.0 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/iconv-nginx-module-0.14 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/echo-nginx-module-0.61 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/xss-nginx-module-0.05 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_coolkit-0.2rc3 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/set-misc-nginx-module-0.31 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/form-input-nginx-module-0.12 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/encrypted-session-nginx-module-0.07 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/srcache-nginx-module-0.31 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua-0.10.11 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua_upstream-0.07 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/headers-more-nginx-module-0.33 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/array-var-nginx-module-0.05 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/memc-nginx-module-0.18 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/redis-nginx-module-0.3.7 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-json-nginx-module-0.15 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-csv-nginx-module-0.08 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_stream_lua-0.0.3 --with-ld-opt<span class="token operator">=</span>-Wl,-rpath,/app/OpenResty2/luajit/lib <span class="token parameter variable">--user</span><span class="token operator">=</span>www <span class="token parameter variable">--group</span><span class="token operator">=</span>www --with-http_realip_module --with-pcre --add-module<span class="token operator">=</span>/app/soft/naxsi-master/naxsi_src --with-http_stub_status_module --with-http_ssl_module --with-stream --with-stream_ssl_module
<span class="token punctuation">[</span>root@localhost sbin<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u67E5\u770B\u5F53\u524D\u7684\u7248\u672C\u53F7" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u5F53\u524D\u7684\u7248\u672C\u53F7" aria-hidden="true">#</a> \u67E5\u770B\u5F53\u524D\u7684\u7248\u672C\u53F7</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@Super sbin<span class="token punctuation">]</span><span class="token comment"># ./nginx -V</span>
nginx version: openresty/1.11.2.5
built by gcc <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-28<span class="token punctuation">)</span> <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span>
built with OpenSSL <span class="token number">1.0</span>.2k-fips  <span class="token number">26</span> Jan <span class="token number">2017</span>
TLS SNI support enabled
configure arguments: <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/opt/openresty//nginx --with-cc-opt<span class="token operator">=</span>-O2 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_devel_kit-0.3.0 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/echo-nginx-module-0.61 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/xss-nginx-module-0.05 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_coolkit-0.2rc3 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/set-misc-nginx-module-0.31 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/form-input-nginx-module-0.12 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/encrypted-session-nginx-module-0.06 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/srcache-nginx-module-0.31 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua-0.10.10 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua_upstream-0.07 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/headers-more-nginx-module-0.32 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/array-var-nginx-module-0.05 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/memc-nginx-module-0.18 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/redis2-nginx-module-0.14 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/redis-nginx-module-0.3.7 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-json-nginx-module-0.14 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-csv-nginx-module-0.07 --with-ld-opt<span class="token operator">=</span>-Wl,-rpath,/opt/openresty/luajit/lib --add-module<span class="token operator">=</span>/opt/soft/naxsi-master/naxsi_src --with-http_ssl_module --with-http_stub_status_module
<span class="token punctuation">[</span>root@Super sbin<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u4E0B\u8F7D\u8981\u5347\u7EA7\u7684\u7248\u672C\u3001\u91CD\u65B0\u7F16\u8BD1" tabindex="-1"><a class="header-anchor" href="#\u4E0B\u8F7D\u8981\u5347\u7EA7\u7684\u7248\u672C\u3001\u91CD\u65B0\u7F16\u8BD1" aria-hidden="true">#</a> \u4E0B\u8F7D\u8981\u5347\u7EA7\u7684\u7248\u672C\u3001\u91CD\u65B0\u7F16\u8BD1</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@Super soft<span class="token punctuation">]</span><span class="token comment"># wget  </span>
<span class="token punctuation">[</span>root@Super soft<span class="token punctuation">]</span><span class="token comment"># tar -zxvf openresty-1.13.6.2.tar.gz</span>
<span class="token punctuation">[</span>root@Super soft<span class="token punctuation">]</span><span class="token comment"># cd openresty-1.13.6.2</span>
<span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment"># ./configure --prefix=/opt/openresty/ --add-module=/opt/soft/naxsi-master/naxsi_src --with-http_ssl_module --with-http_stub_status_module --with-luajit</span>
<span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment"># gmake</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6B64\u6B65\u5207\u8BB0\u4E0D\u8981make install</p><h5 id="\u5907\u4EFD\u8001\u7684nginx\u6587\u4EF6\u3001\u8986\u76D6\u6700\u65B0\u7684\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5907\u4EFD\u8001\u7684nginx\u6587\u4EF6\u3001\u8986\u76D6\u6700\u65B0\u7684\u6587\u4EF6" aria-hidden="true">#</a> \u5907\u4EFD\u8001\u7684nginx\u6587\u4EF6\u3001\u8986\u76D6\u6700\u65B0\u7684\u6587\u4EF6</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment"># mv /opt/openresty/nginx/sbin/nginx{,.20180907bak}</span>
<span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment"># cp build/nginx-1.13.6/objs/nginx /opt/openresty/nginx/sbin/</span>
<span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment"># /opt/openresty/nginx/sbin/nginx -t -c /opt/openresty/nginx/conf/nginx.conf</span>
nginx: the configuration <span class="token function">file</span> /opt/openresty/nginx/conf/nginx.conf syntax is ok
nginx: configuration <span class="token function">file</span> /opt/openresty/nginx/conf/nginx.conf <span class="token builtin class-name">test</span> is successful
<span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u4F7F\u7528make-upgrade\u66FF\u6362\u8001\u7684nginx\u8FDB\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528make-upgrade\u66FF\u6362\u8001\u7684nginx\u8FDB\u7A0B" aria-hidden="true">#</a> \u4F7F\u7528make upgrade\u66FF\u6362\u8001\u7684nginx\u8FDB\u7A0B</h5><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment"># make upgrade</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6B64\u6B65\u5728\u8981\u5347\u7EA7\u7684\u65B0\u7248\u672C\u4E2D\u6267\u884C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@Super openresty-1.13.6.2<span class="token punctuation">]</span><span class="token comment"># /opt/openresty/nginx/sbin/nginx -V</span>
nginx version: openresty/1.13.6.2
built by gcc <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-28<span class="token punctuation">)</span> <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span>
built with OpenSSL <span class="token number">1.0</span>.2k-fips  <span class="token number">26</span> Jan <span class="token number">2017</span>
TLS SNI support enabled
configure arguments: <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/opt/openresty//nginx --with-cc-opt<span class="token operator">=</span>-O2 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_devel_kit-0.3.0 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/echo-nginx-module-0.61 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/xss-nginx-module-0.06 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_coolkit-0.2rc3 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/set-misc-nginx-module-0.32 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/form-input-nginx-module-0.12 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/encrypted-session-nginx-module-0.08 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/srcache-nginx-module-0.31 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua-0.10.13 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_lua_upstream-0.07 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/headers-more-nginx-module-0.33 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/array-var-nginx-module-0.05 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/memc-nginx-module-0.19 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/redis2-nginx-module-0.15 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/redis-nginx-module-0.3.7 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-json-nginx-module-0.15 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/rds-csv-nginx-module-0.09 --add-module<span class="token operator">=</span><span class="token punctuation">..</span>/ngx_stream_lua-0.0.5 --with-ld-opt<span class="token operator">=</span>-Wl,-rpath,/opt/openresty/luajit/lib --add-module<span class="token operator">=</span>/opt/soft/naxsi-master/naxsi_src --with-http_ssl_module --with-http_stub_status_module --with-stream
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,20),o=[t];function l(i,c){return s(),a("div",null,o)}const u=n(p,[["render",l],["__file","openresty.html.vue"]]);export{u as default};
