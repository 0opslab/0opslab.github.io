import{_ as s,o as n,c as a,e}from"./app.a667bd71.js";const t={},p=e(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#\`\`\`ops</span>
<span class="token comment">#title:\u8F6E\u8BE2\u7CFB\u7EDF\u72B6\u6001</span>
<span class="token comment">#descr:\u4E00\u4E2A\u53EF\u4EE5\u518D\u7EBF\u4E0A\u7A0D\u4F5C\u4FEE\u6539\u5C31\u53EF\u4F7F\u7528\u7684\u811A\u672CPolling system status by script </span>
<span class="token comment">#\`\`\`</span>
<span class="token comment"># Arch: CentOS/RHEL 6/7</span>

<span class="token comment">#set path env,if not set will some command not found in crontab</span>

<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
<span class="token builtin class-name">source</span> /etc/profile


<span class="token comment"># run this script use root</span>
<span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-u</span><span class="token variable">)</span></span> <span class="token parameter variable">-gt</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;please use root run the script! &quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span>

<span class="token comment"># check system  version</span>
<span class="token assign-left variable">OS_Version</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&#39;{print $(NF-1)}&#39;</span> /etc/redhat-release<span class="token variable">)</span></span>

<span class="token comment"># declare script version date</span>
<span class="token assign-left variable">Script_Version</span><span class="token operator">=</span><span class="token string">&quot;2018.02.07&quot;</span>


<span class="token comment"># define polling log path</span>
<span class="token assign-left variable">LOGPATH</span><span class="token operator">=</span>/var/log/polling
<span class="token assign-left variable">card</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ip</span> addr <span class="token operator">|</span><span class="token function">grep</span> inet <span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;inet6|127.0.0.1&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $NF}&#39;</span><span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-n</span> 1p<span class="token variable">)</span></span>
<span class="token assign-left variable">ipaddr</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ifconfig</span> $card <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-2</span> <span class="token operator">|</span> <span class="token function">tail</span> -1<span class="token operator">|</span> <span class="token function">cut</span> -d: -f2<span class="token operator">|</span><span class="token function">cut</span> -d<span class="token string">&#39; &#39;</span> <span class="token parameter variable">-f1</span><span class="token variable">)</span></span>
<span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token variable">$LOGPATH</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$LOGPATH</span>
<span class="token assign-left variable">RESULTFILE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$LOGPATH</span>/HostDailyCheck-<span class="token variable">$ipaddr</span>-<span class="token variable"><span class="token variable">\`</span><span class="token function">hostname</span><span class="token variable">\`</span></span>-<span class="token variable"><span class="token variable">\`</span><span class="token function">date</span> +%Y%m%d<span class="token variable">\`</span></span>.txt&quot;</span>


<span class="token comment"># define globle variable</span>
<span class="token assign-left variable">report_DateTime</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u65E5\u671F ok</span>
<span class="token assign-left variable">report_Hostname</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u4E3B\u673A\u540D ok</span>
<span class="token assign-left variable">report_OSRelease</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u53D1\u884C\u7248\u672C ok</span>
<span class="token assign-left variable">report_Kernel</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u5185\u6838 ok</span>
<span class="token assign-left variable">report_Language</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u8BED\u8A00/\u7F16\u7801 ok</span>
<span class="token assign-left variable">report_LastReboot</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u6700\u8FD1\u542F\u52A8\u65F6\u95F4 ok</span>
<span class="token assign-left variable">report_Uptime</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u8FD0\u884C\u65F6\u95F4\uFF08\u5929\uFF09 ok</span>
<span class="token assign-left variable">report_CPUs</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#CPU\u6570\u91CF ok</span>
<span class="token assign-left variable">report_CPUType</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#CPU\u7C7B\u578B ok</span>
<span class="token assign-left variable">report_Arch</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#CPU\u67B6\u6784 ok</span>
<span class="token assign-left variable">report_MemTotal</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u5185\u5B58\u603B\u5BB9\u91CF(MB) ok</span>
<span class="token assign-left variable">report_MemFree</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u5185\u5B58\u5269\u4F59(MB) ok</span>
<span class="token assign-left variable">report_MemUsedPercent</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u5185\u5B58\u4F7F\u7528\u7387% ok</span>
<span class="token assign-left variable">report_DiskTotal</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u786C\u76D8\u603B\u5BB9\u91CF(GB) ok</span>
<span class="token assign-left variable">report_DiskFree</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u786C\u76D8\u5269\u4F59(GB) ok</span>
<span class="token assign-left variable">report_DiskUsedPercent</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u786C\u76D8\u4F7F\u7528\u7387% ok</span>
<span class="token assign-left variable">report_InodeTotal</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#Inode\u603B\u91CF ok</span>
<span class="token assign-left variable">report_InodeFree</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#Inode\u5269\u4F59 ok</span>
<span class="token assign-left variable">report_InodeUsedPercent</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#Inode\u4F7F\u7528\u7387 ok</span>
<span class="token assign-left variable">report_IP</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#IP\u5730\u5740 ok</span>
<span class="token assign-left variable">report_MAC</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#MAC\u5730\u5740 ok</span>
<span class="token assign-left variable">report_Gateway</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u9ED8\u8BA4\u7F51\u5173 ok</span>
<span class="token assign-left variable">report_DNS</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#DNS ok</span>
<span class="token assign-left variable">report_Listen</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u76D1\u542C ok</span>
<span class="token assign-left variable">report_Selinux</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#Selinux ok</span>
<span class="token assign-left variable">report_Firewall</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u9632\u706B\u5899 ok</span>
<span class="token assign-left variable">report_USERs</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u7528\u6237 ok</span>
<span class="token assign-left variable">report_USEREmptyPassword</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>   <span class="token comment">#\u7A7A\u5BC6\u7801\u7528\u6237 ok</span>
<span class="token assign-left variable">report_USERTheSameUID</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>      <span class="token comment">#\u76F8\u540CID\u7684\u7528\u6237 ok </span>
<span class="token assign-left variable">report_PasswordExpiry</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u5BC6\u7801\u8FC7\u671F\uFF08\u5929\uFF09 ok</span>
<span class="token assign-left variable">report_RootUser</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#root\u7528\u6237 ok</span>
<span class="token assign-left variable">report_Sudoers</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#sudo\u6388\u6743  ok</span>
<span class="token assign-left variable">report_SSHAuthorized</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#SSH\u4FE1\u4EFB\u4E3B\u673A ok</span>
<span class="token assign-left variable">report_SSHDProtocolVersion</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#SSH\u534F\u8BAE\u7248\u672C ok</span>
<span class="token assign-left variable">report_SSHDPermitRootLogin</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u5141\u8BB8root\u8FDC\u7A0B\u767B\u5F55 ok</span>
<span class="token assign-left variable">report_DefunctProsess</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u50F5\u5C38\u8FDB\u7A0B\u6570\u91CF ok</span>
<span class="token assign-left variable">report_SelfInitiatedService</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u81EA\u542F\u52A8\u670D\u52A1\u6570\u91CF ok</span>
<span class="token assign-left variable">report_SelfInitiatedProgram</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u81EA\u542F\u52A8\u7A0B\u5E8F\u6570\u91CF ok</span>
<span class="token assign-left variable">report_RuningService</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>           <span class="token comment">#\u8FD0\u884C\u4E2D\u670D\u52A1\u6570  ok</span>
<span class="token assign-left variable">report_Crontab</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u8BA1\u5212\u4EFB\u52A1\u6570 ok</span>
<span class="token assign-left variable">report_Syslog</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#\u65E5\u5FD7\u670D\u52A1 ok</span>
<span class="token assign-left variable">report_SNMP</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#SNMP  OK</span>
<span class="token assign-left variable">report_NTP</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#NTP ok</span>
<span class="token assign-left variable">report_JDK</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>    <span class="token comment">#JDK\u7248\u672C ok</span>


<span class="token keyword">function</span> <span class="token function-name function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;System Polling\uFF1AVersion <span class="token variable">$Script_Version</span> &quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getCpuStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check CPU Status#############################&quot;</span>
    <span class="token assign-left variable">Physical_CPUs</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">&quot;physical id&quot;</span> /proc/cpuinfo<span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">Virt_CPUs</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">&quot;processor&quot;</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">CPU_Kernels</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">&quot;cores&quot;</span> /proc/cpuinfo<span class="token operator">|</span><span class="token function">uniq</span><span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&#39;: &#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">CPU_Type</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">&quot;model name&quot;</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&#39;: &#39;</span> <span class="token string">&#39;{print $2}&#39;</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">CPU_Arch</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-m</span><span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;\u7269\u7406CPU\u4E2A\u6570:<span class="token variable">$Physical_CPUs</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;\u903B\u8F91CPU\u4E2A\u6570:<span class="token variable">$Virt_CPUs</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;\u6BCFCPU\u6838\u5FC3\u6570:<span class="token variable">$CPU_Kernels</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;    CPU\u578B\u53F7:<span class="token variable">$CPU_Type</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;    CPU\u67B6\u6784:<span class="token variable">$CPU_Arch</span>&quot;</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_CPUs</span><span class="token operator">=</span><span class="token variable">$Virt_CPUs</span>    <span class="token comment">#CPU\u6570\u91CF</span>
    <span class="token assign-left variable">report_CPUType</span><span class="token operator">=</span><span class="token variable">$CPU_Type</span>  <span class="token comment">#CPU\u7C7B\u578B</span>
    <span class="token assign-left variable">report_Arch</span><span class="token operator">=</span><span class="token variable">$CPU_Arch</span>     <span class="token comment">#CPU\u67B6\u6784</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getMemStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Memmory Usage ###########################&quot;</span>
    <span class="token assign-left variable">MemTotal</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&#39;/MemTotal/ {print $2}&#39;</span> /proc/meminfo<span class="token variable">)</span></span>  <span class="token comment">#KB</span>
    <span class="token assign-left variable">MemFree</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&#39;/MemFree/ {print $2}&#39;</span> /proc/meminfo<span class="token variable">)</span></span>   <span class="token comment">#KB</span>
    <span class="token assign-left variable">Buffers</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&#39;/^Buffers:/ {print $2}&#39;</span> /proc/meminfo<span class="token variable">)</span></span>
    <span class="token assign-left variable">Cached</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&#39;/^Cached:/ {print $2}&#39;</span> /proc/meminfo<span class="token variable">)</span></span>
    <span class="token assign-left variable">FreeMem</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$MemFree<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">+</span>$Buffers<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">+</span>$Cached<span class="token operator">/</span><span class="token number">1024</span><span class="token variable">))</span></span>
    <span class="token assign-left variable">UsedMem</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$MemTotal<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">-</span>$FreeMem<span class="token variable">))</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$OS_Version</span> <span class="token operator">&lt;</span> <span class="token number">7</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token function">free</span> <span class="token parameter variable">-mo</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Total memory is <span class="token variable"><span class="token variable">$((</span>$MemTotal<span class="token operator">/</span><span class="token number">1024</span><span class="token variable">))</span></span> MB&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Free  memory is <span class="token variable">\${FreeMem}</span> MB&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Used  memory is <span class="token variable">\${UsedMem}</span> MB&quot;</span>

    <span class="token keyword">else</span>
        <span class="token function">free</span> <span class="token parameter variable">-h</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Total memory is <span class="token variable"><span class="token variable">$((</span>$MemTotal<span class="token operator">/</span><span class="token number">1024</span><span class="token variable">))</span></span> MB&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Free  memory is <span class="token variable">\${FreeMem}</span> MB&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Used  memory is <span class="token variable">\${UsedMem}</span> MB&quot;</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># report information</span>
    <span class="token builtin class-name">let</span> <span class="token assign-left variable">MemUsed</span><span class="token operator">=</span>MemTotal-MemFree
    <span class="token assign-left variable">MemPercent</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&quot;BEGIN {if(<span class="token variable">$MemTotal</span>==0){printf 100}else{printf <span class="token entity" title="\\&quot;">\\&quot;</span>%.2f<span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token variable">$MemUsed</span>*100/<span class="token variable">$MemTotal</span>}}&quot;</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">report_MemTotal</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$((</span>MemTotal<span class="token operator">/</span><span class="token number">1024</span><span class="token variable">))</span></span>&quot;</span>&quot;MB<span class="token string">&quot;        #\u5185\u5B58\u603B\u5BB9\u91CF(MB)
    report_MemFree=&quot;</span><span class="token variable"><span class="token variable">$((</span>MemFree<span class="token operator">/</span><span class="token number">1024</span><span class="token variable">))</span></span><span class="token string">&quot;&quot;</span>MB<span class="token string">&quot;          #\u5185\u5B58\u5269\u4F59(MB)
    report_MemUsedPercent=&quot;</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&quot;BEGIN {if(<span class="token variable">$MemTotal</span>==0){printf 100}else{printf <span class="token entity" title="\\&quot;">\\&quot;</span>%.2f<span class="token entity" title="\\&quot;">\\&quot;</span>,<span class="token variable">$MemUsed</span>*100/<span class="token variable">$MemTotal</span>}}&quot;</span><span class="token variable">)</span></span><span class="token string">&quot;&quot;</span>%<span class="token string">&quot;   #\u5185\u5B58\u4F7F\u7528\u7387%
}


function getDiskStatus(){
    echo &quot;</span>&quot;
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Disk Status ############################&quot;</span>
    <span class="token function">df</span> <span class="token parameter variable">-hiP</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/Mounted on/Mounted/&#39;</span> <span class="token operator">&gt;</span> /tmp/inode
    <span class="token function">df</span> <span class="token parameter variable">-hTP</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/Mounted on/Mounted/&#39;</span> <span class="token operator">&gt;</span> /tmp/disk 
    <span class="token function">join</span> /tmp/disk /tmp/inode <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1,$2,&quot;|&quot;,$3,$4,$5,$6,&quot;|&quot;,$8,$9,$10,$11,&quot;|&quot;,$12}&#39;</span><span class="token operator">|</span> <span class="token function">column</span> <span class="token parameter variable">-t</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">diskdata</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">df</span> <span class="token parameter variable">-TP</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;1d&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;$2!=&quot;tmpfs&quot;{print}&#39;</span><span class="token variable">)</span></span> <span class="token comment">#KB</span>
    <span class="token assign-left variable">disktotal</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$diskdata</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{total+=$3}END{print total}&#39;</span><span class="token variable">)</span></span> <span class="token comment">#KB</span>
    <span class="token assign-left variable">diskused</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$diskdata</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{total+=$4}END{print total}&#39;</span><span class="token variable">)</span></span>  <span class="token comment">#KB</span>
    <span class="token assign-left variable">diskfree</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>disktotal<span class="token operator">-</span>diskused<span class="token variable">))</span></span> <span class="token comment">#KB</span>
    <span class="token assign-left variable">diskusedpercent</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $disktotal $diskused <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{if($1==0){printf 100}else{printf &quot;%.2f&quot;,$2*100/$1}}&#39;</span><span class="token variable">)</span></span> 
    <span class="token assign-left variable">inodedata</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">df</span> <span class="token parameter variable">-iTP</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;1d&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;$2!=&quot;tmpfs&quot;{print}&#39;</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">inodetotal</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$inodedata</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{total+=$3}END{print total}&#39;</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">inodeused</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$inodedata</span>&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{total+=$4}END{print total}&#39;</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">inodefree</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>inodetotal<span class="token operator">-</span>inodeused<span class="token variable">))</span></span>
    <span class="token assign-left variable">inodeusedpercent</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $inodetotal $inodeused <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{if($1==0){printf 100}else{printf &quot;%.2f&quot;,$2*100/$1}}&#39;</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">report_DiskTotal</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>disktotal<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token variable">))</span></span><span class="token string">&quot;GB&quot;</span>   <span class="token comment">#\u786C\u76D8\u603B\u5BB9\u91CF(GB)</span>
    <span class="token assign-left variable">report_DiskFree</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>diskfree<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token variable">))</span></span><span class="token string">&quot;GB&quot;</span>     <span class="token comment">#\u786C\u76D8\u5269\u4F59(GB)</span>
    <span class="token assign-left variable">report_DiskUsedPercent</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$diskusedpercent</span>&quot;</span>&quot;%<span class="token string">&quot;    #\u786C\u76D8\u4F7F\u7528\u7387%
    report_InodeTotal=<span class="token variable"><span class="token variable">$((</span>inodetotal<span class="token operator">/</span><span class="token number">1000</span><span class="token variable">))</span></span>&quot;</span>K<span class="token string">&quot;       #Inode\u603B\u91CF
    report_InodeFree=<span class="token variable"><span class="token variable">$((</span>inodefree<span class="token operator">/</span><span class="token number">1000</span><span class="token variable">))</span></span>&quot;</span>K<span class="token string">&quot;         #Inode\u5269\u4F59
    report_InodeUsedPercent=&quot;</span><span class="token variable">$inodeusedpercent</span><span class="token string">&quot;&quot;</span>%<span class="token string">&quot;  #Inode\u4F7F\u7528\u7387%
    echo &quot;</span>&quot;
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getSystemStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check System Status ############################&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> /etc/sysconfig/i18n <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token assign-left variable">default_LANG</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">&quot;LANG=&quot;</span> /etc/sysconfig/i18n <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;^#&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&#39;&quot;&#39;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>&quot;</span>
    <span class="token keyword">else</span>
        <span class="token assign-left variable">default_LANG</span><span class="token operator">=</span><span class="token environment constant">$LANG</span>
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;en_US.UTF-8&quot;</span>
    <span class="token assign-left variable">Release</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/redhat-release <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null<span class="token variable">)</span></span>
    <span class="token assign-left variable">Kernel</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-r</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">OS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-o</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">Hostname</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-n</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">SELinux</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>/usr/sbin/sestatus <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;SELinux status: &quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $3}&#39;</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">LastReboot</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">who</span> <span class="token parameter variable">-b</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $3,$4}&#39;</span><span class="token variable">)</span></span>
<span class="token comment">#    uptime=$(uptime | sed &#39;s/.*up [,]*, .*/\\1/&#39;)</span>
    <span class="token assign-left variable">uptime</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">awk</span> <span class="token string">&#39;{a=$1/86400;b=($1%86400)/3600;c=($1%3600)/60} {printf(&quot;%d days, %d hour %d min\\n&quot;,a,b,c)}&#39;</span> /proc/uptime<span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;     \u7CFB\u7EDF\uFF1A<span class="token variable">$OS</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; \u53D1\u884C\u7248\u672C\uFF1A<span class="token variable">$Release</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;     \u5185\u6838\uFF1A<span class="token variable">$Kernel</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;   \u4E3B\u673A\u540D\uFF1A<span class="token variable">$Hostname</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;  SELinux\uFF1A<span class="token variable">$SELinux</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;\u8BED\u8A00/\u7F16\u7801\uFF1A<span class="token variable">$default_LANG</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; \u5F53\u524D\u65F6\u95F4\uFF1A<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&#39;%F %T&#39;</span><span class="token variable">)</span></span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; \u6700\u540E\u542F\u52A8\uFF1A<span class="token variable">$LastReboot</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; \u8FD0\u884C\u65F6\u95F4\uFF1A<span class="token variable">$uptime</span>&quot;</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_DateTime</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +<span class="token string">&quot;%F %T&quot;</span><span class="token variable">)</span></span>  <span class="token comment">#\u65E5\u671F</span>
    <span class="token assign-left variable">report_Hostname</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$Hostname</span>&quot;</span>       <span class="token comment">#\u4E3B\u673A\u540D</span>
    <span class="token assign-left variable">report_OSRelease</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$Release</span>&quot;</span>       <span class="token comment">#\u53D1\u884C\u7248\u672C</span>
    <span class="token assign-left variable">report_Kernel</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$Kernel</span>&quot;</span>           <span class="token comment">#\u5185\u6838</span>
    <span class="token assign-left variable">report_Language</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$default_LANG</span>&quot;</span>   <span class="token comment">#\u8BED\u8A00/\u7F16\u7801</span>
    <span class="token assign-left variable">report_LastReboot</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$LastReboot</span>&quot;</span>   <span class="token comment">#\u6700\u8FD1\u542F\u52A8\u65F6\u95F4</span>
    <span class="token assign-left variable">report_Uptime</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$uptime</span>&quot;</span>           <span class="token comment">#\u8FD0\u884C\u65F6\u95F4\uFF08\u5929\uFF09</span>
    <span class="token assign-left variable">report_Selinux</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$SELinux</span>&quot;</span>
    <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$default_LANG</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getServiceStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Service Status ############################&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$OS_Version</span> <span class="token operator">&gt;</span> <span class="token number">7</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token assign-left variable">conf</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>systemctl list-unit-files <span class="token parameter variable">--type</span><span class="token operator">=</span>service <span class="token parameter variable">--state</span><span class="token operator">=</span>enabled --no-pager <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;enabled&quot;</span><span class="token variable">)</span></span>
        <span class="token assign-left variable">process</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>systemctl list-units <span class="token parameter variable">--type</span><span class="token operator">=</span>service <span class="token parameter variable">--state</span><span class="token operator">=</span>running --no-pager <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;.service&quot;</span><span class="token variable">)</span></span>
        <span class="token comment"># report information</span>
        <span class="token assign-left variable">report_SelfInitiatedService</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$conf</span>&quot;</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>&quot;</span>       <span class="token comment">#\u81EA\u542F\u52A8\u670D\u52A1\u6570\u91CF</span>
        <span class="token assign-left variable">report_RuningService</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$process</span>&quot;</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>&quot;</span>           <span class="token comment">#\u8FD0\u884C\u4E2D\u670D\u52A1\u6570\u91CF</span>
    <span class="token keyword">else</span>
        <span class="token assign-left variable">conf</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>/sbin/chkconfig --list<span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">&quot;:on|:\u542F\u7528&quot;</span><span class="token variable">)</span></span>
        <span class="token assign-left variable">process</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>/sbin/service --status-all <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">&quot;is running|\u6B63\u5728\u8FD0\u884C&quot;</span><span class="token variable">)</span></span>
        <span class="token comment"># report information</span>
        <span class="token assign-left variable">report_SelfInitiatedService</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$conf</span>&quot;</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>&quot;</span>       <span class="token comment">#\u81EA\u542F\u52A8\u670D\u52A1\u6570\u91CF</span>
        <span class="token assign-left variable">report_RuningService</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$process</span>&quot;</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>&quot;</span>           <span class="token comment">#\u8FD0\u884C\u4E2D\u670D\u52A1\u6570\u91CF</span>
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Service Configure&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;--------------------------------&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$conf</span>&quot;</span> <span class="token operator">|</span> <span class="token function">column</span> <span class="token parameter variable">-t</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;The Running Services&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;--------------------------------&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$process</span>&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getAutoStartStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Self-starting Services ##########################&quot;</span>
    <span class="token assign-left variable">conf</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;^#&quot;</span> /etc/rc.d/rc.local<span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;/^$/d&#39;</span><span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$conf</span>&quot;</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_SelfInitiatedProgram</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $conf <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>&quot;</span>    <span class="token comment">#\u81EA\u542F\u52A8\u7A0B\u5E8F\u6570\u91CF</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getLoginStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Login In ############################&quot;</span>
    last <span class="token operator">|</span> <span class="token function">head</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getNetworkStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Network ############################&quot;</span>
   <span class="token assign-left variable">DEVICE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ip</span> addr <span class="token operator">|</span><span class="token function">grep</span> inet <span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;inet6|127.0.0.1&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $NF}&#39;</span><span class="token variable">)</span></span>
   <span class="token assign-left variable">IP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ip</span> addr <span class="token operator">|</span><span class="token function">grep</span> inet <span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;inet6|127.0.0.1&quot;</span> <span class="token operator">|</span><span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span> <span class="token operator">|</span><span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&quot;/&quot;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token operator">|</span><span class="token function">tr</span> <span class="token string">&#39;\\n&#39;</span> <span class="token string">&#39;,&#39;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/,$//&#39;</span><span class="token variable">)</span></span>
   <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">\`</span><span class="token function">ip</span> addr <span class="token operator">|</span><span class="token function">grep</span> inet <span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;inet6|127.0.0.1&quot;</span> <span class="token operator">|</span><span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span> <span class="token operator">|</span><span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&quot;/&quot;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">\`</span></span> <span class="token operator">&lt;</span> <span class="token number">2</span>  <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
      <span class="token assign-left variable">MAC</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /sys/class/net/$DEVICE/address<span class="token variable">)</span></span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;    MAC: <span class="token variable">$MAC</span>&quot;</span>
     <span class="token keyword">else</span>
       <span class="token keyword">for</span> <span class="token for-or-select variable">ips</span> <span class="token keyword">in</span> <span class="token variable">$DEVICE</span><span class="token punctuation">;</span>
         <span class="token keyword">do</span>
            <span class="token assign-left variable">MAC</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /sys/class/net/$ips/address<span class="token variable">)</span></span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;    MAC: <span class="token variable">$MAC</span>&quot;</span><span class="token punctuation">;</span>
       <span class="token keyword">done</span>
   <span class="token keyword">fi</span>
   <span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ip</span> route <span class="token operator">|</span> <span class="token function">grep</span> default <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $3}&#39;</span><span class="token variable">)</span></span>
   <span class="token assign-left variable">DNS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> nameserver /etc/resolv.conf<span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;#&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">&#39;\\n&#39;</span> <span class="token string">&#39;,&#39;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/,$//&#39;</span><span class="token variable">)</span></span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;     IP: <span class="token variable">$IP</span>&quot;</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;Gateway: <span class="token variable">$GATEWAY</span>&quot;</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;    DNS: <span class="token variable">$DNS</span>&quot;</span>
    <span class="token comment"># report information</span>
<span class="token comment">#    IP=$(ip -f inet addr | grep -v 127.0.0.1 |  grep inet | awk &#39;{print $NF,$2}&#39; | tr &#39;\\n&#39; &#39;,&#39; | sed &#39;s/,$//&#39;)</span>
<span class="token comment">#    MAC=$(ip link | grep -v &quot;LOOPBACK\\|loopback&quot; | awk &#39;{print $2}&#39; | sed &#39;N;s/\\n//&#39; | tr &#39;\\n&#39; &#39;,&#39; | sed &#39;s/,$//&#39;)</span>
    <span class="token assign-left variable">report_IP</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$IP</span>&quot;</span>            <span class="token comment">#IP\u5730\u5740</span>
    <span class="token assign-left variable">report_MAC</span><span class="token operator">=</span><span class="token variable">$MAC</span>            <span class="token comment">#MAC\u5730\u5740</span>
    <span class="token assign-left variable">report_Gateway</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$GATEWAY</span>&quot;</span>  <span class="token comment">#\u9ED8\u8BA4\u7F51\u5173</span>
    <span class="token assign-left variable">report_DNS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$DNS</span>&quot;</span>          <span class="token comment">#DNS</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getListenStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Connect Status ############################&quot;</span>
<span class="token comment">#    TCPListen=$(ss -ntul | column -t)</span>
    <span class="token assign-left variable">TCPListen</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">netstat</span> <span class="token parameter variable">-ntulp</span> <span class="token operator">|</span> <span class="token function">column</span> <span class="token parameter variable">-t</span><span class="token variable">)</span></span>
<span class="token comment">#    AllConnect=$(ss -an | awk &#39;NR&gt;1 {++s[$1]} END {for(k in s) print k,s[k]}&#39; | column -t)</span>
    <span class="token assign-left variable">AllConnect</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">netstat</span> <span class="token parameter variable">-tan</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;/^tcp\\&gt;/{state[$NF]++}END{for(i in state) { print i,state[i]}}&#39;</span><span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$TCPListen</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$AllConnect</span>&quot;</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_Listen</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$TCPListen</span>&quot;</span><span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;1d&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;/tcp/ {print $5}&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> -F: <span class="token string">&#39;{print $NF}&#39;</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getCronStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Check Crontab ########################&quot;</span>
    <span class="token assign-left variable">Crontab</span><span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">shell</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;/sbin/nologin&quot;</span> /etc/shells<span class="token variable">)</span></span><span class="token punctuation">;</span><span class="token keyword">do</span>
        <span class="token keyword">for</span> <span class="token for-or-select variable">user</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">&quot;<span class="token variable">$shell</span>&quot;</span> /etc/passwd <span class="token operator">|</span> <span class="token function">awk</span> -F: <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">)</span></span><span class="token punctuation">;</span><span class="token keyword">do</span>
            <span class="token function">crontab</span> <span class="token parameter variable">-l</span> <span class="token parameter variable">-u</span> <span class="token variable">$user</span> <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
            <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token variable">$?</span>
            <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$status</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$user</span>&quot;</span>
                <span class="token builtin class-name">echo</span> <span class="token string">&quot;-------------&quot;</span>
                <span class="token function">crontab</span> <span class="token parameter variable">-l</span> <span class="token parameter variable">-u</span> <span class="token variable">$user</span>
                <span class="token builtin class-name">let</span> <span class="token assign-left variable">Crontab</span><span class="token operator">=</span>Crontab+<span class="token variable"><span class="token variable">$(</span><span class="token function">crontab</span> <span class="token parameter variable">-l</span> <span class="token parameter variable">-u</span> $user <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>
                <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
            <span class="token keyword">fi</span>
        <span class="token keyword">done</span>
    <span class="token keyword">done</span>
    <span class="token comment"># scheduled task</span>
    <span class="token function">find</span> /etc/cron* <span class="token parameter variable">-type</span> f <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token parameter variable">-i</span> <span class="token function">ls</span> <span class="token parameter variable">-l</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">column</span>  <span class="token parameter variable">-t</span>
    <span class="token builtin class-name">let</span> <span class="token assign-left variable">Crontab</span><span class="token operator">=</span>Crontab+<span class="token variable"><span class="token variable">$(</span><span class="token function">find</span> /etc/cron* <span class="token parameter variable">-type</span> f <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_Crontab</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$Crontab</span>&quot;</span>    <span class="token comment">#\u8BA1\u5212\u4EFB\u52A1\u6570</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getHowLongAgo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment"># \u8BA1\u7B97\u4E00\u4E2A\u65F6\u95F4\u6233\u79BB\u73B0\u5728\u6709\u591A\u4E45\u4E86</span>
    <span class="token assign-left variable">datetime</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$*</span>&quot;</span>
    <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">&quot;<span class="token variable">$datetime</span>&quot;</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;\u9519\u8BEF\u7684\u53C2\u6570\uFF1AgetHowLongAgo() <span class="token variable">$*</span>&quot;</span>
    <span class="token assign-left variable">Timestamp</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$datetime</span>&quot;</span><span class="token variable">)</span></span>    <span class="token comment">#\u8F6C\u5316\u4E3A\u65F6\u95F4\u6233</span>
    <span class="token assign-left variable">Now_Timestamp</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token assign-left variable">Difference_Timestamp</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$Now_Timestamp<span class="token operator">-</span>$Timestamp<span class="token variable">))</span></span>
    <span class="token assign-left variable">days</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token assign-left variable">hours</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token assign-left variable">minutes</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token assign-left variable">sec_in_day</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">24</span><span class="token variable">))</span></span><span class="token punctuation">;</span>
    <span class="token assign-left variable">sec_in_hour</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token variable">))</span></span><span class="token punctuation">;</span>
    <span class="token assign-left variable">sec_in_minute</span><span class="token operator">=</span><span class="token number">60</span>
    <span class="token keyword">while</span> <span class="token variable"><span class="token punctuation">((</span> $<span class="token punctuation">((</span>$Difference_Timestamp<span class="token operator">-</span>$sec_in_day<span class="token punctuation">))</span></span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token punctuation">))</span>
    <span class="token keyword">do</span>
        <span class="token builtin class-name">let</span> <span class="token assign-left variable">Difference_Timestamp</span><span class="token operator">=</span>Difference_Timestamp-sec_in_day
        <span class="token builtin class-name">let</span> days++
    <span class="token keyword">done</span>
    <span class="token keyword">while</span> <span class="token variable"><span class="token punctuation">((</span> $<span class="token punctuation">((</span>$Difference_Timestamp<span class="token operator">-</span>$sec_in_hour<span class="token punctuation">))</span></span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token punctuation">))</span>
    <span class="token keyword">do</span>
        <span class="token builtin class-name">let</span> <span class="token assign-left variable">Difference_Timestamp</span><span class="token operator">=</span>Difference_Timestamp-sec_in_hour
        <span class="token builtin class-name">let</span> hours++
    <span class="token keyword">done</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$days</span> \u5929 <span class="token variable">$hours</span> \u5C0F\u65F6\u524D&quot;</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getUserLastLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment"># \u83B7\u53D6\u7528\u6237\u6700\u8FD1\u4E00\u6B21\u767B\u5F55\u7684\u65F6\u95F4\uFF0C\u542B\u5E74\u4EFD</span>
    <span class="token comment"># \u5F88\u9057\u61BElast\u547D\u4EE4\u4E0D\u652F\u6301\u663E\u793A\u5E74\u4EFD\uFF0C\u53EA\u6709&quot;last -t YYYYMMDDHHMMSS&quot;\u8868\u793A\u67D0\u4E2A\u65F6\u95F4\u4E4B\u95F4\u7684\u767B\u5F55\uFF0C\u6211</span>
    <span class="token comment"># \u4EEC\u53EA\u80FD\u7528\u6700\u7B28\u7684\u65B9\u6CD5\u4E86\uFF0C\u5BF9\u6BD4\u4ECA\u5929\u4E4B\u524D\u548C\u4ECA\u5E74\u5143\u65E6\u4E4B\u524D\uFF08\u6216\u8005\u53BB\u5E74\u4E4B\u524D\u548C\u524D\u5E74\u4E4B\u524D\u2026\u2026\uFF09\u67D0\u4E2A\u7528\u6237</span>
    <span class="token comment"># \u767B\u5F55\u6B21\u6570\uFF0C\u5982\u679C\u767B\u5F55\u7EDF\u8BA1\u6B21\u6570\u6709\u53D8\u5316\uFF0C\u5219\u8BF4\u660E\u6700\u8FD1\u4E00\u6B21\u767B\u5F55\u662F\u4ECA\u5E74\u3002</span>
    <span class="token assign-left variable">username</span><span class="token operator">=</span><span class="token variable">$1</span>
    <span class="token builtin class-name">:</span> <span class="token variable">\${username<span class="token operator">:=</span>&quot;\`whoami\`&quot;}</span>
    <span class="token assign-left variable">thisYear</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y<span class="token variable">)</span></span>
    <span class="token assign-left variable">oldesYear</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>last <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-n1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $NF}&#39;</span><span class="token variable">)</span></span>
    <span class="token keyword">while</span><span class="token variable"><span class="token punctuation">((</span> $thisYear <span class="token operator">&gt;=</span> $oldesYear<span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token keyword">do</span>
        <span class="token assign-left variable">loginBeforeToday</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>last $username <span class="token operator">|</span> <span class="token function">grep</span> $username <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>
        <span class="token assign-left variable">loginBeforeNewYearsDayOfThisYear</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>last $username <span class="token parameter variable">-t</span> $thisYear<span class="token string">&quot;0101000000&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> $username <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$loginBeforeToday</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;Never Login&quot;</span>
            <span class="token builtin class-name">break</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$loginBeforeToday</span> <span class="token parameter variable">-gt</span> <span class="token variable">$loginBeforeNewYearsDayOfThisYear</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
            <span class="token assign-left variable">lastDateTime</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>last <span class="token parameter variable">-i</span> $username <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n1</span> <span class="token operator">|</span> <span class="token function">awk</span> &#39;<span class="token punctuation">{</span>for<span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token punctuation">(</span>NF-2<span class="token punctuation">)</span><span class="token punctuation">;</span>i++<span class="token variable">)</span></span><span class="token builtin class-name">printf</span><span class="token string">&quot;%s &quot;</span>,<span class="token variable">$i</span><span class="token punctuation">}</span><span class="token string">&#39;)&quot; $thisYear&quot; #\u683C\u5F0F\u5982: Sat Nov 2 20:33 2015
            lastDateTime=$(date &quot;+%Y-%m-%d %H:%M:%S&quot; -d &quot;$lastDateTime&quot;)
            echo &quot;$lastDateTime&quot;
            break
        else
            thisYear=$((thisYear-1))
        fi
    done
}

function getUserStatus(){
    echo &quot;&quot;
    echo &quot;############################ Check User ############################&quot;
    # /etc/passwd the last modification time
    pwdfile=&quot;$(cat /etc/passwd)&quot;
    Modify=$(stat /etc/passwd | grep Modify | tr &#39;</span><span class="token builtin class-name">.</span><span class="token string">&#39; &#39;</span> <span class="token string">&#39; | awk &#39;</span><span class="token punctuation">{</span>print <span class="token variable">$2</span>,<span class="token variable">$3</span><span class="token punctuation">}</span><span class="token string">&#39;)
    echo &quot;/etc/passwd The last modification time\uFF1A$Modify ($(getHowLongAgo $Modify))&quot;
    echo &quot;&quot;
    echo &quot;A privileged user&quot;
    echo &quot;-----------------&quot;
    RootUser=&quot;&quot;
    for user in $(echo &quot;$pwdfile&quot; | awk -F: &#39;</span><span class="token punctuation">{</span>print <span class="token variable">$1</span><span class="token punctuation">}</span><span class="token string">&#39;);do
        if [ $(id -u $user) -eq 0 ];then
            echo &quot;$user&quot;
            RootUser=&quot;$RootUser,$user&quot;
        fi
    done
    echo &quot;&quot;
    echo &quot;User List&quot;
    echo &quot;--------&quot;
    USERs=0
    echo &quot;$(
    echo &quot;UserName UID GID HOME SHELL LasttimeLogin&quot;
    for shell in $(grep -v &quot;/sbin/nologin&quot; /etc/shells);do
        for username in $(grep &quot;$shell&quot; /etc/passwd| awk -F: &#39;</span><span class="token punctuation">{</span>print <span class="token variable">$1</span><span class="token punctuation">}</span><span class="token string">&#39;);do
            userLastLogin=&quot;$(getUserLastLogin $username)&quot;
            echo &quot;$pwdfile&quot; | grep -w &quot;$username&quot; |grep -w &quot;$shell&quot;| awk -F: -v lastlogin=&quot;$(echo &quot;$userLastLogin&quot; | tr &#39;</span> <span class="token string">&#39; &#39;</span>_<span class="token string">&#39;)&quot; &#39;</span><span class="token punctuation">{</span>print <span class="token variable">$1</span>,<span class="token variable">$3</span>,<span class="token variable">$4</span>,<span class="token variable">$6</span>,<span class="token variable">$7</span>,lastlogin<span class="token punctuation">}</span><span class="token string">&#39;
        done
        let USERs=USERs+$(echo &quot;$pwdfile&quot; | grep &quot;$shell&quot;| wc -l)
    done
    )&quot; | column -t
    echo &quot;&quot;
    echo &quot;Null Password User&quot;
    echo &quot;------------------&quot;
    USEREmptyPassword=&quot;&quot;
    for shell in $(grep -v &quot;/sbin/nologin&quot; /etc/shells);do
            for user in $(echo &quot;$pwdfile&quot; | grep &quot;$shell&quot; | cut -d: -f1);do
            r=$(awk -F: &#39;</span><span class="token variable">$2</span><span class="token operator">==</span><span class="token string">&quot;!!&quot;</span><span class="token punctuation">{</span>print <span class="token variable">$1</span><span class="token punctuation">}</span><span class="token string">&#39; /etc/shadow | grep -w $user)
            if [ ! -z $r ];then
                echo $r
                USEREmptyPassword=&quot;$USEREmptyPassword,&quot;$r
            fi
        done    
    done
    echo &quot;&quot;
    echo &quot;The Same UID User&quot;
    echo &quot;----------------&quot;
    USERTheSameUID=&quot;&quot;
    UIDs=$(cut -d: -f3 /etc/passwd | sort | uniq -c | awk &#39;</span><span class="token variable">$1</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">{</span>print <span class="token variable">$2</span><span class="token punctuation">}</span><span class="token string">&#39;)
    for uid in $UIDs;do
        echo -n &quot;$uid&quot;;
        USERTheSameUID=&quot;$uid&quot;
        r=$(awk -F: &#39;</span><span class="token assign-left variable">ORS</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">;</span><span class="token variable">$3</span><span class="token operator">==</span><span class="token string">&#39;&quot;$uid&quot;&#39;</span><span class="token punctuation">{</span>print <span class="token string">&quot;:&quot;</span>,<span class="token variable">$1</span><span class="token punctuation">}</span><span class="token string">&#39; /etc/passwd)
        echo &quot;$r&quot;
        echo &quot;&quot;
        USERTheSameUID=&quot;$USERTheSameUID $r,&quot;
    done
    # report information
    report_USERs=&quot;$USERs&quot;    #\u7528\u6237
    report_USEREmptyPassword=$(echo $USEREmptyPassword | sed &#39;</span>s/^,//<span class="token string">&#39;) 
    report_USERTheSameUID=$(echo $USERTheSameUID | sed &#39;</span>s/,$//<span class="token string">&#39;) 
    report_RootUser=$(echo $RootUser | sed &#39;</span>s/^,//<span class="token string">&#39;)    #\u7279\u6743\u7528\u6237
}


function getPasswordStatus {
    echo &quot;&quot;
    echo &quot;############################ Check Password Status ############################&quot;
    pwdfile=&quot;$(cat /etc/passwd)&quot;
    echo &quot;&quot;
    echo &quot;Password Expiration Check&quot;
    echo &quot;-------------------------&quot;
    result=&quot;&quot;
    for shell in $(grep -v &quot;/sbin/nologin&quot; /etc/shells);do
        for user in $(echo &quot;$pwdfile&quot; | grep &quot;$shell&quot; | cut -d: -f1);do
            get_expiry_date=$(/usr/bin/chage -l $user | grep &#39;</span>Password expires<span class="token string">&#39; | cut -d: -f2)
            if [[ $get_expiry_date = &#39;</span> never<span class="token string">&#39; || $get_expiry_date = &#39;</span>never<span class="token string">&#39; ]];then
                printf &quot;%-15s never expiration\\n&quot; $user
                result=&quot;$result,$user:never&quot;
            else
                password_expiry_date=$(date -d &quot;$get_expiry_date&quot; &quot;+%s&quot;)
                current_date=$(date &quot;+%s&quot;)
                diff=$(($password_expiry_date-$current_date))
                let DAYS=$(($diff/(60*60*24)))
                printf &quot;%-15s %s expiration after days\\n&quot; $user $DAYS
                result=&quot;$result,$user:$DAYS days&quot;
            fi
        done
    done
    report_PasswordExpiry=$(echo $result | sed &#39;</span>s/^,//<span class="token string">&#39;)
    echo &quot;&quot;
    echo &quot;Check The Password Policy&quot;
    echo &quot;------------&quot;
    grep -v &quot;#&quot; /etc/login.defs | grep -E &quot;PASS_MAX_DAYS|PASS_MIN_DAYS|PASS_MIN_LEN|PASS_WARN_AGE&quot;
    echo &quot;&quot;
}

function getSudoersStatus(){
    echo &quot;&quot;
    echo &quot;############################ Sudoers Check #########################&quot;
    conf=$(grep -v &quot;^#&quot; /etc/sudoers| grep -v &quot;^Defaults&quot; | sed &#39;</span>/^$/d<span class="token string">&#39;)
    echo &quot;$conf&quot;
    echo &quot;&quot;
    # report information
    report_Sudoers=&quot;$(echo $conf | wc -l)&quot;
}


function getInstalledStatus(){
    echo &quot;&quot;
    echo &quot;############################ Software Check ############################&quot;
    rpm -qa --last | head | column -t 
}

function getProcessStatus(){
    echo &quot;&quot;
    echo &quot;############################ Process Check ############################&quot;
    if [ $(ps -ef | grep defunct | grep -v grep | wc -l) -ge 1 ];then
        echo &quot;&quot;
        echo &quot;zombie process&quot;;
        echo &quot;--------&quot;
        ps -ef | head -n1
        ps -ef | grep defunct | grep -v grep
    fi
    echo &quot;&quot;
    echo &quot;Merory Usage TOP10&quot;
    echo &quot;-------------&quot;
    echo -e &quot;PID %MEM RSS COMMAND
    $(ps aux | awk &#39;</span><span class="token punctuation">{</span>print <span class="token variable">$2</span>, <span class="token variable">$4</span>, <span class="token variable">$6</span>, <span class="token variable">$11</span><span class="token punctuation">}</span><span class="token string">&#39; | sort -k3rn | head -n 10 )&quot;| column -t 
    echo &quot;&quot;
    echo &quot;CPU Usage TOP10&quot;
    echo &quot;------------&quot;
    top b -n1 | head -17 | tail -11
    # report information
    report_DefunctProsess=&quot;$(ps -ef | grep defunct | grep -v grep|wc -l)&quot;
}


function getJDKStatus(){
    echo &quot;&quot;
    echo &quot;############################ JDK Check #############################&quot;
    java -version 2&gt;/dev/null
    if [ $? -eq 0 ];then
        java -version 2&gt;&amp;1
    fi
    echo &quot;JAVA_HOME=\\&quot;$JAVA_HOME\\&quot;&quot;
    # report information
    report_JDK=&quot;$(java -version 2&gt;&amp;1 | grep version | awk &#39;</span><span class="token punctuation">{</span>print <span class="token variable">$1</span>,<span class="token variable">$3</span><span class="token punctuation">}</span><span class="token string">&#39; | tr -d &#39;</span><span class="token string">&quot;&#39;)&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getSyslogStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Syslog Check ##########################&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Service Status\uFF1A<span class="token variable"><span class="token variable">$(</span>getState rsyslog<span class="token variable">)</span></span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;/etc/rsyslog.conf&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;-----------------&quot;</span>
    <span class="token function">cat</span> /etc/rsyslog.conf <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;^#&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;^<span class="token entity" title="\\\\">\\\\</span>$&quot;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;/^$/d&#39;</span>  <span class="token operator">|</span> <span class="token function">column</span> <span class="token parameter variable">-t</span>
    <span class="token comment">#report information</span>
    <span class="token assign-left variable">report_Syslog</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>getState rsyslog<span class="token variable">)</span></span>&quot;</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getFirewallStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ Firewall Check ##########################&quot;</span>
    <span class="token comment"># Firewall Status/Poilcy</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$OS_Version</span> <span class="token operator">&lt;</span> <span class="token number">7</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        /etc/init.d/iptables status <span class="token operator">&gt;</span>/dev/null  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
        <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token variable">$?</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$status</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                <span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">&quot;active&quot;</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$status</span> <span class="token parameter variable">-eq</span> <span class="token number">3</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                <span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">&quot;inactive&quot;</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$status</span> <span class="token parameter variable">-eq</span> <span class="token number">4</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                <span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">&quot;permission denied&quot;</span>
        <span class="token keyword">else</span>
                <span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">&quot;unknown&quot;</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">else</span>
        <span class="token assign-left variable">s</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>getState iptables<span class="token variable">)</span></span>&quot;</span>
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;iptables: <span class="token variable">$s</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;/etc/sysconfig/iptables&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;-----------------------&quot;</span>
    <span class="token function">cat</span> /etc/sysconfig/iptables <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_Firewall</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$s</span>&quot;</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">getSNMPStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">#SNMP Service Status,Configure</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ SNMP Check ############################&quot;</span>
    <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>getState snmpd<span class="token variable">)</span></span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Service Status\uFF1A<span class="token variable">$status</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> /etc/snmp/snmpd.conf <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;/etc/snmp/snmpd.conf&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;--------------------&quot;</span>
        <span class="token function">cat</span> /etc/snmp/snmpd.conf <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;^#&quot;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;/^$/d&#39;</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_SNMP</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>getState snmpd<span class="token variable">)</span></span>&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$OS_Version</span> <span class="token operator">&lt;</span> <span class="token number">7</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;/etc/init.d/<span class="token variable">$1</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
            <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">\`</span>/etc/init.d/$1 status <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">&quot;is running|\u6B63\u5728\u8FD0\u884C&quot;</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">\`</span></span> <span class="token parameter variable">-ge</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                <span class="token assign-left variable">r</span><span class="token operator">=</span><span class="token string">&quot;active&quot;</span>
            <span class="token keyword">else</span>
                <span class="token assign-left variable">r</span><span class="token operator">=</span><span class="token string">&quot;inactive&quot;</span>
            <span class="token keyword">fi</span>
        <span class="token keyword">else</span>
            <span class="token assign-left variable">r</span><span class="token operator">=</span><span class="token string">&quot;unknown&quot;</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">else</span>
        <span class="token comment">#CentOS 7+</span>
        <span class="token assign-left variable">r</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>systemctl is-active $1 <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token variable">)</span></span>&quot;</span>
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$r</span>&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getSSHStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">#SSHD Service Status,Configure</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ SSH Check #############################&quot;</span>
    <span class="token comment"># Check the trusted host</span>
    <span class="token assign-left variable">pwdfile</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/passwd<span class="token variable">)</span></span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Service Status\uFF1A<span class="token variable"><span class="token variable">$(</span>getState sshd<span class="token variable">)</span></span>&quot;</span>
    <span class="token assign-left variable">Protocol_Version</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/ssh/sshd_config <span class="token operator">|</span> <span class="token function">grep</span> Protocol <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;SSH Protocol Version\uFF1A<span class="token variable">$Protocol_Version</span>&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Trusted Host&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;------------&quot;</span>
    <span class="token assign-left variable">authorized</span><span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token for-or-select variable">user</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$pwdfile</span>&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> /bin/bash <span class="token operator">|</span> <span class="token function">awk</span> -F: <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">)</span></span><span class="token punctuation">;</span><span class="token keyword">do</span>
        <span class="token assign-left variable">authorize_file</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$pwdfile</span>&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-w</span> $user <span class="token operator">|</span> <span class="token function">awk</span> -F: <span class="token string">&#39;{printf $6&quot;/.ssh/authorized_keys&quot;}&#39;</span><span class="token variable">)</span></span>
        <span class="token assign-left variable">authorized_host</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $authorize_file <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $3}&#39;</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">&#39;\\n&#39;</span> <span class="token string">&#39;,&#39;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;s/,$//&#39;</span><span class="token variable">)</span></span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token variable">$authorized_host</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$user</span> authorization <span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$authorized_host</span><span class="token entity" title="\\&quot;">\\&quot;</span> Password-less access&quot;</span>
        <span class="token keyword">fi</span>
        <span class="token builtin class-name">let</span> <span class="token assign-left variable">authorized</span><span class="token operator">=</span>authorized+<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $authorize_file <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $3}&#39;</span><span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">)</span></span>
    <span class="token keyword">done</span>


    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Whether to allow ROOT remote login&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------------------------&quot;</span>
    <span class="token assign-left variable">config</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/ssh/sshd_config <span class="token operator">|</span> <span class="token function">grep</span> PermitRootLogin<span class="token variable">)</span></span>
    <span class="token assign-left variable">firstChar</span><span class="token operator">=</span><span class="token variable">\${config<span class="token operator">:</span>0<span class="token operator">:</span>1}</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$firstChar</span> <span class="token operator">==</span> <span class="token string">&quot;#&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token assign-left variable">PermitRootLogin</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>  <span class="token comment">#The default is to allow ROOT remote login</span>
    <span class="token keyword">else</span>
        <span class="token assign-left variable">PermitRootLogin</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $config <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;PermitRootLogin <span class="token variable">$PermitRootLogin</span>&quot;</span>


    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;/etc/ssh/sshd_config&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;--------------------&quot;</span>
    <span class="token function">cat</span> /etc/ssh/sshd_config <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;^#&quot;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;/^$/d&#39;</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_SSHAuthorized</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$authorized</span>&quot;</span>    <span class="token comment">#SSH\u4FE1\u4EFB\u4E3B\u673A</span>
    <span class="token assign-left variable">report_SSHDProtocolVersion</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$Protocol_Version</span>&quot;</span>    <span class="token comment">#SSH\u534F\u8BAE\u7248\u672C</span>
    <span class="token assign-left variable">report_SSHDPermitRootLogin</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$PermitRootLogin</span>&quot;</span>    <span class="token comment">#\u5141\u8BB8root\u8FDC\u7A0B\u767B\u5F55</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getNTPStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment"># The NTP service status, the current time, configuration, etc</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ NTP Check #############################&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> /etc/ntp.conf <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;Service Status\uFF1A<span class="token variable"><span class="token variable">$(</span>getState ntpd<span class="token variable">)</span></span>&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;/etc/ntp.conf&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;-------------&quot;</span>
        <span class="token function">cat</span> /etc/ntp.conf <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&quot;^#&quot;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&#39;/^$/d&#39;</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># report information</span>
    <span class="token assign-left variable">report_NTP</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>getState ntpd<span class="token variable">)</span></span>&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">getZabbixStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment"># Check Zabbix Serivce Status</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;######################### Zabbix Check ##############################&quot;</span>
    <span class="token function">netstat</span> <span class="token parameter variable">-nltp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span> <span class="token operator">|</span> <span class="token function">grep</span> zabbix <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
       <span class="token builtin class-name">echo</span> <span class="token string">&quot;Service Status&quot;</span><span class="token builtin class-name">:</span> Zabbix is running<span class="token operator">!</span>
    <span class="token keyword">else</span>
       <span class="token builtin class-name">echo</span> <span class="token string">&quot;Service Status&quot;</span><span class="token builtin class-name">:</span> Zabbix not running<span class="token operator">!</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># report information</span>
<span class="token punctuation">}</span>

<span class="token comment"># Upload the result file  #\u4E0A\u4F20\u68C0\u67E5\u7ED3\u679C\u7684\u6587\u4EF6,\u66F4\u6539ftp\u76F8\u5173\u4FE1\u606F\u5373\u53EF</span>
<span class="token keyword">function</span> <span class="token function-name function">upload_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;############################ FTP Upload #############################&quot;</span>

    <span class="token assign-left variable">updir</span><span class="token operator">=</span>/var/log/polling
    <span class="token assign-left variable">upfile</span><span class="token operator">=</span>HostDailyCheck-<span class="token variable">$ipaddr</span>-<span class="token variable"><span class="token variable">\`</span><span class="token function">hostname</span><span class="token variable">\`</span></span>-<span class="token variable"><span class="token variable">\`</span><span class="token function">date</span> +%Y%m%d<span class="token variable">\`</span></span>.txt
    <span class="token assign-left variable">todir</span><span class="token operator">=</span>/jishu/liujian/polling
    <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token number">192.168</span>.1.99
    <span class="token assign-left variable">user</span><span class="token operator">=</span>ljohn1
    <span class="token assign-left variable">password</span><span class="token operator">=</span>ljohn
    <span class="token function">ftp</span> <span class="token parameter variable">-nv</span> <span class="token variable">$ip</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF 
    user <span class="token variable">$user</span> <span class="token variable">$password</span>
    type binary 
    passive
    cd <span class="token variable">$todir</span> 
    lcd <span class="token variable">$updir</span>
    prompt
    put <span class="token variable">$upfile</span>
    quit 
EOF</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">uploadHostDailyCheckReport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token assign-left variable">json</span><span class="token operator">=</span><span class="token string">&quot;{
        <span class="token entity" title="\\&quot;">\\&quot;</span>DateTime<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_DateTime</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Hostname<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Hostname</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>OSRelease<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_OSRelease</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Kernel<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Kernel</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Language<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Language</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>LastReboot<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_LastReboot</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Uptime<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Uptime</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>CPUs<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_CPUs</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>CPUType<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_CPUType</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Arch<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Arch</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>MemTotal<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_MemTotal</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>MemFree<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_MemFree</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>MemUsedPercent<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_MemUsedPercent</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>DiskTotal<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_DiskTotal</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>DiskFree<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_DiskFree</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>DiskUsedPercent<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_DiskUsedPercent</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>InodeTotal<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_InodeTotal</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>InodeFree<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_InodeFree</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>InodeUsedPercent<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_InodeUsedPercent</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>IP<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_IP</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>MAC<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_MAC</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Gateway<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Gateway</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>DNS<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_DNS</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Listen<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Listen</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Selinux<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Selinux</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Firewall<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Firewall</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>USERs<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_USERs</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>USEREmptyPassword<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_USEREmptyPassword</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>USERTheSameUID<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_USERTheSameUID</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>PasswordExpiry<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_PasswordExpiry</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>RootUser<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_RootUser</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Sudoers<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Sudoers</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>SSHAuthorized<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_SSHAuthorized</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>SSHDProtocolVersion<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_SSHDProtocolVersion</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>SSHDPermitRootLogin<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_SSHDPermitRootLogin</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>DefunctProsess<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_DefunctProsess</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>SelfInitiatedService<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_SelfInitiatedService</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>SelfInitiatedProgram<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_SelfInitiatedProgram</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>RuningService<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_RuningService</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Crontab<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Crontab</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>Syslog<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_Syslog</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>SNMP<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_SNMP</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>NTP<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_NTP</span><span class="token entity" title="\\&quot;">\\&quot;</span>,
        <span class="token entity" title="\\&quot;">\\&quot;</span>JDK<span class="token entity" title="\\&quot;">\\&quot;</span>:<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">$report_JDK</span><span class="token entity" title="\\&quot;">\\&quot;</span>
    }&quot;</span>
    <span class="token comment">#echo &quot;$json&quot; </span>
    <span class="token function">curl</span> <span class="token parameter variable">-l</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;Content-type: application/json&quot;</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$json</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$uploadHostDailyCheckReportApi</span>&quot;</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-name function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    version
    getSystemStatus
    getCpuStatus
    getMemStatus
    getDiskStatus
    getNetworkStatus
    getListenStatus
    getProcessStatus
    getServiceStatus
    getAutoStartStatus
    getLoginStatus
    getCronStatus
    getUserStatus
    getPasswordStatus
    getSudoersStatus
    getJDKStatus
    getFirewallStatus
    getSSHStatus
    getSyslogStatus
    getSNMPStatus
    getNTPStatus
    getZabbixStatus
    getInstalledStatus
    upload_result
    <span class="token comment">#uploadHostDailyCheckReport</span>
<span class="token punctuation">}</span>

<span class="token comment"># Perform inspections and save the inspection results  #\u6267\u884C\u68C0\u67E5\u5E76\u4FDD\u5B58\u68C0\u67E5\u7ED3\u679C</span>
check <span class="token operator">&gt;</span> <span class="token variable">$RESULTFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Check the result\uFF1A<span class="token variable">$RESULTFILE</span>&quot;</span>

<span class="token comment"># Clearlog in /var/log/polling</span>
<span class="token function">find</span> /var/log/polling <span class="token parameter variable">-type</span> f <span class="token parameter variable">-ctime</span> +7 <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> 

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),o=[p];function l(i,c){return n(),a("div",null,o)}const u=s(t,[["render",l],["__file","HostsDailyCheck-sh.html.vue"]]);export{u as default};
