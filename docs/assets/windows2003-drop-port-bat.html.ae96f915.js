import{_ as s,o as a,c as n,e}from"./app.a667bd71.js";const p={},t=e(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\uFEFF::\`\`<span class="token variable"><span class="token variable">\`</span>ops
::title:\u914D\u7F6Ewindows2003\u7CFB\u7EDF\u7684IP\u5B89\u5168\u7B56\u7565
::descr:
::<span class="token variable">\`</span></span>\`\`

rem \u6062\u590D\u9632\u706B\u5899\u5230\u9ED8\u8BA4\u503C
netsh advfirewall reset
	 
rem \u8BBE\u7F6E\u53D8\u91CFoffices_vpn\u4E0Einternal_servers
<span class="token builtin class-name">set</span> <span class="token assign-left variable">offices_vpn</span><span class="token operator">=</span><span class="token number">203.208</span>.11.200/32,119.75.211.56/32,131.253.11.32/32
<span class="token builtin class-name">set</span> <span class="token assign-left variable">internal_servers</span><span class="token operator">=</span><span class="token number">192.168</span>.11.0/16,218.30.118.211/32
 
rem \u5F00\u653E\u7AEF\u53E33389\u5230offices_vpn
netsh advfirewall firewall <span class="token function">add</span> rule <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;\u81EA\u5B9A\u4E49\u89C4\u5219_port3389_from_offices_vpn&quot;</span> <span class="token assign-left variable">dir</span><span class="token operator">=</span>in <span class="token assign-left variable">protocol</span><span class="token operator">=</span>tcp <span class="token assign-left variable">localport</span><span class="token operator">=</span><span class="token number">3389</span> <span class="token assign-left variable">remoteip</span><span class="token operator">=</span>%offices_vpn% <span class="token assign-left variable">action</span><span class="token operator">=</span>allow

rem \u5EFA\u7ACB\u5BF9internal_servers\u4E4B\u95F4\u7684\u76F8\u4E92\u4FE1\u4EFB
netsh advfirewall firewall <span class="token function">add</span> rule <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;\u81EA\u5B9A\u4E49\u89C4\u5219_trust_all_internal_servers&quot;</span> <span class="token assign-left variable">dir</span><span class="token operator">=</span>in <span class="token assign-left variable">remoteip</span><span class="token operator">=</span>%internal_servers% <span class="token assign-left variable">action</span><span class="token operator">=</span>allow

rem \u5F00\u653E\u7AEF\u53E380\u5230\u6240\u6709\u5730\u5740
netsh advfirewall firewall <span class="token function">add</span> rule <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;\u81EA\u5B9A\u4E49\u89C4\u5219_port80_from_anywhere&quot;</span> <span class="token assign-left variable">dir</span><span class="token operator">=</span>in <span class="token assign-left variable">protocol</span><span class="token operator">=</span>tcp <span class="token assign-left variable">localport</span><span class="token operator">=</span><span class="token number">80</span> <span class="token assign-left variable">action</span><span class="token operator">=</span>allow


netsh ipsec static <span class="token function">add</span> policy <span class="token assign-left variable">name</span><span class="token operator">=</span>drop
netsh ipsec static <span class="token function">add</span> filterlist <span class="token assign-left variable">name</span><span class="token operator">=</span>drop_port
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">21</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">22</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">23</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">25</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">53</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">80</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">135</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">139</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">443</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">445</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">1314</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">1433</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">1521</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">2222</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">3306</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">3433</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">3389</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span><span class="token number">192.168</span>.1.2 <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>Me <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">3389</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">4899</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">8080</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">dstport</span><span class="token operator">=</span><span class="token number">18186</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filter <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">srcaddr</span><span class="token operator">=</span>me <span class="token assign-left variable">dstaddr</span><span class="token operator">=</span>any <span class="token assign-left variable">protocol</span><span class="token operator">=</span>UDP <span class="token assign-left variable">mirrored</span><span class="token operator">=</span>no
netsh ipsec static <span class="token function">add</span> filteraction <span class="token assign-left variable">name</span><span class="token operator">=</span>denyact <span class="token assign-left variable">action</span><span class="token operator">=</span>block
netsh ipsec static <span class="token function">add</span> rule <span class="token assign-left variable">name</span><span class="token operator">=</span>kill <span class="token assign-left variable">policy</span><span class="token operator">=</span>drop <span class="token assign-left variable">filterlist</span><span class="token operator">=</span>drop_port <span class="token assign-left variable">filteraction</span><span class="token operator">=</span>denyact
netsh ipsec static <span class="token builtin class-name">set</span> policy <span class="token assign-left variable">name</span><span class="token operator">=</span>drop <span class="token assign-left variable">assign</span><span class="token operator">=</span>y
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),o=[t];function l(r,i){return a(),n("div",null,o)}const k=s(p,[["render",l],["__file","windows2003-drop-port-bat.html.vue"]]);export{k as default};
