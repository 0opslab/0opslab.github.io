import{_ as n,o as s,c as a,e}from"./app.a667bd71.js";const p={},t=e(`<hr><ul><li>\u67E5\u8BE2\u67D0\u4E2A\u7528\u6237\u4E0B\u6700\u8017\u65F6\u7684SQL</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> v<span class="token punctuation">.</span>sql_id<span class="token punctuation">,</span>
   v<span class="token punctuation">.</span>child_number<span class="token punctuation">,</span>
   v<span class="token punctuation">.</span>sql_text<span class="token punctuation">,</span>
   v<span class="token punctuation">.</span>elapsed_time<span class="token punctuation">,</span>
   v<span class="token punctuation">.</span>cpu_time<span class="token punctuation">,</span>
   v<span class="token punctuation">.</span>disk_reads<span class="token punctuation">,</span>
   rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> v<span class="token punctuation">.</span>elapsed_time <span class="token keyword">desc</span><span class="token punctuation">)</span> elapsed_rank<span class="token punctuation">,</span>
   v<span class="token punctuation">.</span>PARSING_SCHEMA_NAME
<span class="token keyword">from</span> v$<span class="token keyword">sql</span> v
<span class="token keyword">where</span> V<span class="token punctuation">.</span>PARSING_SCHEMA_NAME <span class="token operator">=</span> <span class="token string">&#39;xxx&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u603B\u6D88\u8017\u65F6\u95F4\u6700\u591A\u7684\u524D10\u6761SQL\u8BED\u53E5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> v<span class="token punctuation">.</span>sql_id<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>child_number<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>sql_text<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>elapsed_time<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>cpu_time<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>disk_reads<span class="token punctuation">,</span>
rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> v<span class="token punctuation">.</span>elapsed_time <span class="token keyword">desc</span><span class="token punctuation">)</span> elapsed_rank
<span class="token keyword">from</span> v$<span class="token keyword">sql</span> v<span class="token punctuation">)</span> a
<span class="token keyword">where</span> elapsed_rank <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770BCPU\u6D88\u8017\u65F6\u95F4\u6700\u591A\u7684\u524D10\u6761SQL\u8BED\u53E5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> v<span class="token punctuation">.</span>sql_id<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>child_number<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>sql_text<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>elapsed_time<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>cpu_time<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>disk_reads<span class="token punctuation">,</span>
rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> v<span class="token punctuation">.</span>cpu_time <span class="token keyword">desc</span><span class="token punctuation">)</span> elapsed_rank
<span class="token keyword">from</span> v$<span class="token keyword">sql</span> v<span class="token punctuation">)</span> a
<span class="token keyword">where</span> elapsed_rank <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u6D88\u8017\u78C1\u76D8\u8BFB\u53D6\u6700\u591A\u7684\u524D10\u6761SQL\u8BED\u53E5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> v<span class="token punctuation">.</span>sql_id<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>child_number<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>sql_text<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>elapsed_time<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>cpu_time<span class="token punctuation">,</span>
v<span class="token punctuation">.</span>disk_reads<span class="token punctuation">,</span>
rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> v<span class="token punctuation">.</span>disk_reads <span class="token keyword">desc</span><span class="token punctuation">)</span> elapsed_rank
<span class="token keyword">from</span> v$<span class="token keyword">sql</span> v<span class="token punctuation">)</span> a
<span class="token keyword">where</span> elapsed_rank <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u8868\u7A7A\u95F4\u7684\u540D\u79F0\u53CA\u5927\u5C0F</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> t<span class="token punctuation">.</span>tablespace_name<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>bytes<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> ts_size
    <span class="token keyword">from</span> dba_tablespaces t<span class="token punctuation">,</span> dba_data_files d
    <span class="token keyword">where</span> t<span class="token punctuation">.</span>tablespace_name <span class="token operator">=</span> d<span class="token punctuation">.</span>tablespace_name
    <span class="token keyword">group</span> <span class="token keyword">by</span> t<span class="token punctuation">.</span>tablespace_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u8868\u7A7A\u95F4\u7269\u7406\u6587\u4EF6\u7684\u540D\u79F0\u53CA\u5927\u5C0F</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> tablespace_name<span class="token punctuation">,</span> file_id<span class="token punctuation">,</span> file_name<span class="token punctuation">,</span>
    <span class="token function">round</span><span class="token punctuation">(</span>bytes<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> total_space
    <span class="token keyword">from</span> dba_data_files
    <span class="token keyword">order</span> <span class="token keyword">by</span> tablespace_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u56DE\u6EDA\u6BB5\u540D\u79F0\u53CA\u5927\u5C0F</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> segment_name<span class="token punctuation">,</span> tablespace_name<span class="token punctuation">,</span> r<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span>initial_extent<span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span> InitialExtent<span class="token punctuation">,</span><span class="token punctuation">(</span>next_extent<span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span> NextExtent<span class="token punctuation">,</span>
    max_extents<span class="token punctuation">,</span> v<span class="token punctuation">.</span>curext CurExtent
    <span class="token keyword">From</span> dba_rollback_segs r<span class="token punctuation">,</span> v$rollstat v
    <span class="token keyword">Where</span> r<span class="token punctuation">.</span>segment_id <span class="token operator">=</span> v<span class="token punctuation">.</span>usn<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> segment_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u63A7\u5236\u6587\u4EF6</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> name <span class="token keyword">from</span> v$controlfile<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u65E5\u5FD7\u6587\u4EF6</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> member <span class="token keyword">from</span> v$logfile<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u8868\u7A7A\u95F4\u7684\u4F7F\u7528\u60C5\u51B5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token keyword">as</span> free_space<span class="token punctuation">,</span>tablespace_name
    <span class="token keyword">from</span> dba_free_space
    <span class="token keyword">group</span> <span class="token keyword">by</span> tablespace_name<span class="token punctuation">;</span>

    <span class="token keyword">SELECT</span> A<span class="token punctuation">.</span>TABLESPACE_NAME<span class="token punctuation">,</span>A<span class="token punctuation">.</span>BYTES TOTAL<span class="token punctuation">,</span>B<span class="token punctuation">.</span>BYTES USED<span class="token punctuation">,</span> C<span class="token punctuation">.</span>BYTES FREE<span class="token punctuation">,</span>
    <span class="token punctuation">(</span>B<span class="token punctuation">.</span>BYTES<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span>A<span class="token punctuation">.</span>BYTES <span class="token string">&quot;% USED&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span>C<span class="token punctuation">.</span>BYTES<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">/</span>A<span class="token punctuation">.</span>BYTES <span class="token string">&quot;% FREE&quot;</span>
    <span class="token keyword">FROM</span> SYS<span class="token punctuation">.</span>SM$TS_AVAIL A<span class="token punctuation">,</span>SYS<span class="token punctuation">.</span>SM$TS_USED B<span class="token punctuation">,</span>SYS<span class="token punctuation">.</span>SM$TS_FREE C
    <span class="token keyword">WHERE</span> A<span class="token punctuation">.</span>TABLESPACE_NAME<span class="token operator">=</span>B<span class="token punctuation">.</span>TABLESPACE_NAME <span class="token operator">AND</span> A<span class="token punctuation">.</span>TABLESPACE_NAME<span class="token operator">=</span>C<span class="token punctuation">.</span>TABLESPACE_NAME<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u6570\u636E\u5E93\u5E93\u5BF9\u8C61</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> owner<span class="token punctuation">,</span> object_type<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> count<span class="token comment"># from all_objects group by owner, object_type, status;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u6570\u636E\u5E93\u7684\u7248\u672C</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">Select</span> version <span class="token keyword">FROM</span> Product_component_version
    <span class="token keyword">Where</span> SUBSTR<span class="token punctuation">(</span>PRODUCT<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">&#39;Oracle&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u6570\u636E\u5E93\u7684\u521B\u5EFA\u65E5\u671F\u548C\u5F52\u6863\u65B9\u5F0F</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">Select</span> Created<span class="token punctuation">,</span> Log_Mode<span class="token punctuation">,</span> Log_Mode <span class="token keyword">From</span> V$<span class="token keyword">Database</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u6355\u6349\u8FD0\u884C\u5F88\u4E45\u7684SQL</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">column</span> username format a12
    <span class="token keyword">column</span> opname format a16
    <span class="token keyword">column</span> progress format a8

    <span class="token keyword">select</span> username<span class="token punctuation">,</span>sid<span class="token punctuation">,</span>opname<span class="token punctuation">,</span>
    <span class="token function">round</span><span class="token punctuation">(</span>sofar<span class="token operator">*</span><span class="token number">100</span> <span class="token operator">/</span> totalwork<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;%&#39;</span> <span class="token keyword">as</span> progress<span class="token punctuation">,</span>
    time_remaining<span class="token punctuation">,</span>sql_text
    <span class="token keyword">from</span> v$session_longops <span class="token punctuation">,</span> v$<span class="token keyword">sql</span>
    <span class="token keyword">where</span> time_remaining <span class="token operator">&lt;&gt;</span> <span class="token number">0</span>
    <span class="token operator">and</span> sql_address <span class="token operator">=</span> address
    <span class="token operator">and</span> sql_hash_value <span class="token operator">=</span> hash_value
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u6570\u636E\u8868\u7684\u53C2\u6570\u4FE1\u606F</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">SELECT</span>   partition_name<span class="token punctuation">,</span> high_value<span class="token punctuation">,</span> high_value_length<span class="token punctuation">,</span> tablespace_name<span class="token punctuation">,</span>
    pct_free<span class="token punctuation">,</span> pct_used<span class="token punctuation">,</span> ini_trans<span class="token punctuation">,</span> max_trans<span class="token punctuation">,</span> initial_extent<span class="token punctuation">,</span>
    next_extent<span class="token punctuation">,</span> min_extent<span class="token punctuation">,</span> max_extent<span class="token punctuation">,</span> pct_increase<span class="token punctuation">,</span> FREELISTS<span class="token punctuation">,</span>
    freelist_groups<span class="token punctuation">,</span> LOGGING<span class="token punctuation">,</span> BUFFER_POOL<span class="token punctuation">,</span> num_rows<span class="token punctuation">,</span> blocks<span class="token punctuation">,</span>
    empty_blocks<span class="token punctuation">,</span> avg_space<span class="token punctuation">,</span> chain_cnt<span class="token punctuation">,</span> avg_row_len<span class="token punctuation">,</span> sample_size<span class="token punctuation">,</span>
    last_analyzed
    <span class="token keyword">FROM</span> dba_tab_partitions
    <span class="token comment">--WHERE table_name = :tname AND table_owner = :towner</span>
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> partition_position
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u8FD8\u6CA1\u63D0\u4EA4\u7684\u4E8B\u52A1</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> v$locked_object<span class="token punctuation">;</span>
    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> v$<span class="token keyword">transaction</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u627Eobject\u4E3A\u54EA\u4E9B\u8FDB\u7A0B\u6240\u7528</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span>
    p<span class="token punctuation">.</span>spid<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment"># serial_num,</span>
    s<span class="token punctuation">.</span>username user_name<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span><span class="token keyword">type</span>  object_type<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>osuser os_user_name<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>owner<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>object object_name<span class="token punctuation">,</span>
    decode<span class="token punctuation">(</span>sign<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">-</span> command<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span>
    to_char<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;Action Code #&#39;</span> <span class="token operator">||</span> to_char<span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">action</span><span class="token punctuation">,</span>
    p<span class="token punctuation">.</span>program oracle_process<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>terminal terminal<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>program program<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span><span class="token keyword">status</span> session_status
    <span class="token keyword">from</span> v$<span class="token keyword">session</span> s<span class="token punctuation">,</span> v$access a<span class="token punctuation">,</span> v$process p
    <span class="token keyword">where</span> s<span class="token punctuation">.</span>paddr <span class="token operator">=</span> p<span class="token punctuation">.</span>addr <span class="token operator">and</span>
    s<span class="token punctuation">.</span><span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">&#39;USER&#39;</span> <span class="token operator">and</span>
    a<span class="token punctuation">.</span>sid <span class="token operator">=</span> s<span class="token punctuation">.</span>sid   <span class="token operator">and</span>
    a<span class="token punctuation">.</span>object<span class="token operator">=</span><span class="token string">&#39;SUBSCRIBER_ATTR&#39;</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>username<span class="token punctuation">,</span> s<span class="token punctuation">.</span>osuser
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u56DE\u6EDA\u6BB5\u67E5\u770B</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> rownum<span class="token punctuation">,</span> sys<span class="token punctuation">.</span>dba_rollback_segs<span class="token punctuation">.</span>segment_name Name<span class="token punctuation">,</span> v$rollstat<span class="token punctuation">.</span>extents
    Extents<span class="token punctuation">,</span> v$rollstat<span class="token punctuation">.</span>rssize Size_in_Bytes<span class="token punctuation">,</span> v$rollstat<span class="token punctuation">.</span>xacts XActs<span class="token punctuation">,</span>
    v$rollstat<span class="token punctuation">.</span>gets Gets<span class="token punctuation">,</span> v$rollstat<span class="token punctuation">.</span>waits Waits<span class="token punctuation">,</span> v$rollstat<span class="token punctuation">.</span>writes Writes<span class="token punctuation">,</span>
    sys<span class="token punctuation">.</span>dba_rollback_segs<span class="token punctuation">.</span><span class="token keyword">status</span> <span class="token keyword">status</span> <span class="token keyword">from</span> v$rollstat<span class="token punctuation">,</span> sys<span class="token punctuation">.</span>dba_rollback_segs<span class="token punctuation">,</span>
    v$rollname <span class="token keyword">where</span> v$rollname<span class="token punctuation">.</span>name<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span> <span class="token operator">=</span> sys<span class="token punctuation">.</span>dba_rollback_segs<span class="token punctuation">.</span>segment_name <span class="token operator">and</span>
    v$rollstat<span class="token punctuation">.</span>usn <span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span> <span class="token operator">=</span> v$rollname<span class="token punctuation">.</span>usn <span class="token keyword">order</span> <span class="token keyword">by</span> rownum
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u8017\u8D44\u6E90\u7684\u8FDB\u7A0B\uFF08top session\uFF09</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> s<span class="token punctuation">.</span>schemaname schema_name<span class="token punctuation">,</span>    decode<span class="token punctuation">(</span>sign<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">-</span> command<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    to_char<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;Action Code #&#39;</span> <span class="token operator">||</span> to_char<span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">action</span><span class="token punctuation">,</span>    <span class="token keyword">status</span>
    session_status<span class="token punctuation">,</span>   s<span class="token punctuation">.</span>osuser os_user_name<span class="token punctuation">,</span>   s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>         p<span class="token punctuation">.</span>spid <span class="token punctuation">,</span>         s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment"># serial_num,</span>
    nvl<span class="token punctuation">(</span>s<span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token string">&#39;[Oracle process]&#39;</span><span class="token punctuation">)</span> user_name<span class="token punctuation">,</span>   s<span class="token punctuation">.</span>terminal terminal<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>program program<span class="token punctuation">,</span>   st<span class="token punctuation">.</span><span class="token keyword">value</span> criteria_value  <span class="token keyword">from</span> v$sesstat st<span class="token punctuation">,</span>   v$<span class="token keyword">session</span> s  <span class="token punctuation">,</span> v$process p
    <span class="token keyword">where</span> st<span class="token punctuation">.</span>sid <span class="token operator">=</span> s<span class="token punctuation">.</span>sid <span class="token operator">and</span>   st<span class="token punctuation">.</span>statistic<span class="token comment"># = to_number(&#39;38&#39;) and   (&#39;ALL&#39; = &#39;ALL&#39;</span>
    <span class="token operator">or</span> s<span class="token punctuation">.</span><span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;ALL&#39;</span><span class="token punctuation">)</span> <span class="token operator">and</span> p<span class="token punctuation">.</span>addr <span class="token operator">=</span> s<span class="token punctuation">.</span>paddr <span class="token keyword">order</span> <span class="token keyword">by</span> st<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token keyword">desc</span><span class="token punctuation">,</span>  p<span class="token punctuation">.</span>spid <span class="token keyword">asc</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>username <span class="token keyword">asc</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>osuser <span class="token keyword">asc</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u9501\uFF08lock\uFF09\u60C5\u51B5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span>  ls<span class="token punctuation">.</span>osuser os_user_name<span class="token punctuation">,</span>   ls<span class="token punctuation">.</span>username user_name<span class="token punctuation">,</span>
    decode<span class="token punctuation">(</span>ls<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">,</span> <span class="token string">&#39;RW&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Row wait enqueue lock&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;TM&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;DML enqueue lock&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;TX&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;Transaction enqueue lock&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;UL&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;User supplied lock&#39;</span><span class="token punctuation">)</span> lock_type<span class="token punctuation">,</span>
    o<span class="token punctuation">.</span>object_name object<span class="token punctuation">,</span>   decode<span class="token punctuation">(</span>ls<span class="token punctuation">.</span>lmode<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;Row Share&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">&#39;Row Exclusive&#39;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;Share&#39;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;Share Row Exclusive&#39;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&#39;Exclusive&#39;</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
    lock_mode<span class="token punctuation">,</span>    o<span class="token punctuation">.</span>owner<span class="token punctuation">,</span>   ls<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>   ls<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment"># serial_num,   ls.id1,   ls.id2</span>
    <span class="token keyword">from</span> sys<span class="token punctuation">.</span>dba_objects o<span class="token punctuation">,</span> <span class="token punctuation">(</span>   <span class="token keyword">select</span> s<span class="token punctuation">.</span>osuser<span class="token punctuation">,</span>    s<span class="token punctuation">.</span>username<span class="token punctuation">,</span>    l<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">,</span>
    l<span class="token punctuation">.</span>lmode<span class="token punctuation">,</span>    s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>    s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment">#,    l.id1,    l.id2   from v$session s,</span>
    v$<span class="token keyword">lock</span> l   <span class="token keyword">where</span> s<span class="token punctuation">.</span>sid <span class="token operator">=</span> l<span class="token punctuation">.</span>sid <span class="token punctuation">)</span> ls  <span class="token keyword">where</span> o<span class="token punctuation">.</span>object_id <span class="token operator">=</span> ls<span class="token punctuation">.</span>id1 <span class="token operator">and</span>    o<span class="token punctuation">.</span>owner
    <span class="token operator">&lt;&gt;</span> <span class="token string">&#39;SYS&#39;</span>   <span class="token keyword">order</span> <span class="token keyword">by</span> o<span class="token punctuation">.</span>owner<span class="token punctuation">,</span> o<span class="token punctuation">.</span>object_name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u7B49\u5F85\uFF08wait\uFF09\u60C5\u51B5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">SELECT</span> v$waitstat<span class="token punctuation">.</span>class<span class="token punctuation">,</span> v$waitstat<span class="token punctuation">.</span>count count<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>v$sysstat<span class="token punctuation">.</span><span class="token keyword">value</span><span class="token punctuation">)</span> sum_value
    <span class="token keyword">FROM</span> v$waitstat<span class="token punctuation">,</span> v$sysstat <span class="token keyword">WHERE</span> v$sysstat<span class="token punctuation">.</span>name <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;db block gets&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;consistent gets&#39;</span><span class="token punctuation">)</span> <span class="token keyword">group</span> <span class="token keyword">by</span> v$waitstat<span class="token punctuation">.</span>class<span class="token punctuation">,</span> v$waitstat<span class="token punctuation">.</span>count
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770Bsga\u60C5\u51B5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>	<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span> BYTES <span class="token keyword">FROM</span> SYS<span class="token punctuation">.</span>V_$SGASTAT <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> NAME <span class="token keyword">ASC</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u67E5\u770Bcatched object</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>	<span class="token keyword">SELECT</span> owner<span class="token punctuation">,</span>
       name<span class="token punctuation">,</span>
       db_link<span class="token punctuation">,</span>
       namespace<span class="token punctuation">,</span>
       <span class="token keyword">type</span><span class="token punctuation">,</span>
       sharable_mem<span class="token punctuation">,</span>
       loads<span class="token punctuation">,</span>
       executions<span class="token punctuation">,</span>
       locks<span class="token punctuation">,</span>
       pins<span class="token punctuation">,</span>
       kept
  <span class="token keyword">FROM</span> v$db_object_cache
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770BV$SQLAREA</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">SELECT</span> SQL_TEXT<span class="token punctuation">,</span> SHARABLE_MEM<span class="token punctuation">,</span> PERSISTENT_MEM<span class="token punctuation">,</span> RUNTIME_MEM<span class="token punctuation">,</span> SORTS<span class="token punctuation">,</span>
    VERSION_COUNT<span class="token punctuation">,</span> LOADED_VERSIONS<span class="token punctuation">,</span> OPEN_VERSIONS<span class="token punctuation">,</span> USERS_OPENING<span class="token punctuation">,</span> EXECUTIONS<span class="token punctuation">,</span>
    USERS_EXECUTING<span class="token punctuation">,</span> LOADS<span class="token punctuation">,</span> FIRST_LOAD_TIME<span class="token punctuation">,</span> INVALIDATIONS<span class="token punctuation">,</span> PARSE_CALLS<span class="token punctuation">,</span> DISK_READS<span class="token punctuation">,</span>
    BUFFER_GETS<span class="token punctuation">,</span> ROWS_PROCESSED <span class="token keyword">FROM</span> V$SQLAREA
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770Bobject\u5206\u7C7B\u6570\u91CF</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> decode <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment">#,1,&#39;INDEX&#39; , 2,&#39;TABLE&#39; , 3 , &#39;CLUSTER&#39; , 4, &#39;VIEW&#39; , 5 ,</span>
    <span class="token string">&#39;SYNONYM&#39;</span> <span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">,</span> <span class="token string">&#39;SEQUENCE&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;OTHER&#39;</span> <span class="token punctuation">)</span> object_type <span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> quantity <span class="token keyword">from</span>
    sys<span class="token punctuation">.</span>obj$ o <span class="token keyword">where</span> o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment"># &gt; 1 group by decode (o.type#,1,&#39;INDEX&#39; , 2,&#39;TABLE&#39; , 3</span>
    <span class="token punctuation">,</span> <span class="token string">&#39;CLUSTER&#39;</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;VIEW&#39;</span> <span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">,</span> <span class="token string">&#39;SYNONYM&#39;</span> <span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">,</span> <span class="token string">&#39;SEQUENCE&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;OTHER&#39;</span> <span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span>
    <span class="token string">&#39;COLUMN&#39;</span> <span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>col$ <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token string">&#39;DB LINK&#39;</span> <span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6309\u7528\u6237\u67E5\u770Bobject\u79CD\u7C7B</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> u<span class="token punctuation">.</span>name <span class="token keyword">schema</span><span class="token punctuation">,</span>   <span class="token function">sum</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment">#, 1, 1, NULL)) indexes,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment">#, 2, 1, NULL)) tables,   sum(decode(o.type#, 3, 1, NULL))</span>
    clusters<span class="token punctuation">,</span>   <span class="token function">sum</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment">#, 4, 1, NULL)) views,   sum(decode(o.type#, 5, 1,</span>
    <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> synonyms<span class="token punctuation">,</span>   <span class="token function">sum</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment">#, 6, 1, NULL)) sequences,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment">#, 1, NULL, 2, NULL, 3, NULL, 4, NULL, 5, NULL, 6, NULL, 1))</span>
    others   <span class="token keyword">from</span> sys<span class="token punctuation">.</span>obj$ o<span class="token punctuation">,</span> sys<span class="token punctuation">.</span><span class="token keyword">user</span>$ u   <span class="token keyword">where</span> o<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token comment"># &gt;= 1 and    u.user# =</span>
    o<span class="token punctuation">.</span>owner<span class="token comment"># and   u.name &lt;&gt; &#39;PUBLIC&#39;   group by u.name    order by</span>
    sys<span class="token punctuation">.</span>link$ <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token string">&#39;CONSTRAINT&#39;</span> <span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> sys<span class="token punctuation">.</span>con$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770B\u6709\u54EA\u4E9B\u7528\u6237\u8FDE\u63A5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> s<span class="token punctuation">.</span>osuser os_user_name<span class="token punctuation">,</span>    decode<span class="token punctuation">(</span>sign<span class="token punctuation">(</span><span class="token number">48</span> <span class="token operator">-</span> command<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> to_char<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&#39;Action Code #&#39;</span> <span class="token operator">||</span> to_char<span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">action</span><span class="token punctuation">,</span>     p<span class="token punctuation">.</span>program oracle_process<span class="token punctuation">,</span>
    <span class="token keyword">status</span> session_status<span class="token punctuation">,</span>    s<span class="token punctuation">.</span>terminal terminal<span class="token punctuation">,</span>    s<span class="token punctuation">.</span>program program<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>username user_name<span class="token punctuation">,</span>    s<span class="token punctuation">.</span>fixed_table_sequence activity_meter<span class="token punctuation">,</span>    <span class="token string">&#39;&#39;</span> query<span class="token punctuation">,</span>
    <span class="token number">0</span> memory<span class="token punctuation">,</span>    <span class="token number">0</span> max_memory<span class="token punctuation">,</span>     <span class="token number">0</span> cpu_usage<span class="token punctuation">,</span>    s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>   s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment"># serial_num</span>
    <span class="token keyword">from</span> v$<span class="token keyword">session</span> s<span class="token punctuation">,</span>    v$process p   <span class="token keyword">where</span> s<span class="token punctuation">.</span>paddr<span class="token operator">=</span>p<span class="token punctuation">.</span>addr <span class="token operator">and</span>    s<span class="token punctuation">.</span><span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">&#39;USER&#39;</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>username<span class="token punctuation">,</span> s<span class="token punctuation">.</span>osuser
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6839\u636Ev.sid\u67E5\u770B\u5BF9\u5E94\u8FDE\u63A5\u7684\u8D44\u6E90\u5360\u7528\u7B49\u60C5\u51B5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> n<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    v<span class="token punctuation">.</span><span class="token keyword">value</span><span class="token punctuation">,</span>
    n<span class="token punctuation">.</span>class<span class="token punctuation">,</span>
    n<span class="token punctuation">.</span>statistic<span class="token comment">#</span>
    <span class="token keyword">from</span>  v$statname n<span class="token punctuation">,</span>
    v$sesstat v
    <span class="token keyword">where</span> v<span class="token punctuation">.</span>sid <span class="token operator">=</span> <span class="token number">71</span> <span class="token operator">and</span>
    v<span class="token punctuation">.</span>statistic<span class="token comment"># = n.statistic#</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> n<span class="token punctuation">.</span>class<span class="token punctuation">,</span> n<span class="token punctuation">.</span>statistic<span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6839\u636Esid\u67E5\u770B\u5BF9\u5E94\u8FDE\u63A5\u6B63\u5728\u8FD0\u884C\u7684sql</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span>
    command_type<span class="token punctuation">,</span>
    sql_text<span class="token punctuation">,</span>
    sharable_mem<span class="token punctuation">,</span>
    persistent_mem<span class="token punctuation">,</span>
    runtime_mem<span class="token punctuation">,</span>
    sorts<span class="token punctuation">,</span>
    version_count<span class="token punctuation">,</span>
    loaded_versions<span class="token punctuation">,</span>
    open_versions<span class="token punctuation">,</span>
    users_opening<span class="token punctuation">,</span>
    executions<span class="token punctuation">,</span>
    users_executing<span class="token punctuation">,</span>
    loads<span class="token punctuation">,</span>
    first_load_time<span class="token punctuation">,</span>
    invalidations<span class="token punctuation">,</span>
    parse_calls<span class="token punctuation">,</span>
    disk_reads<span class="token punctuation">,</span>
    buffer_gets<span class="token punctuation">,</span>
    rows_processed<span class="token punctuation">,</span>
    sysdate start_time<span class="token punctuation">,</span>
    sysdate finish_time<span class="token punctuation">,</span>
    <span class="token string">&#39;&gt;&#39;</span> <span class="token operator">||</span> address sql_address<span class="token punctuation">,</span>
    <span class="token string">&#39;N&#39;</span> <span class="token keyword">status</span>
    <span class="token keyword">from</span> v$sqlarea
    <span class="token keyword">where</span> address <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sql_address <span class="token keyword">from</span> v$<span class="token keyword">session</span> <span class="token keyword">where</span> sid <span class="token operator">=</span> <span class="token number">71</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6839\u636Ev.sid\u67E5\u770B\u5BF9\u5E94\u8FDE\u63A5\u7684\u8D44\u6E90\u5360\u7528\u7B49\u60C5\u51B5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> n<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    v<span class="token punctuation">.</span><span class="token keyword">value</span><span class="token punctuation">,</span>
    n<span class="token punctuation">.</span>class<span class="token punctuation">,</span>
    n<span class="token punctuation">.</span>statistic<span class="token comment">#</span>
    <span class="token keyword">from</span>  v$statname n<span class="token punctuation">,</span>
    v$sesstat v
    <span class="token keyword">where</span> v<span class="token punctuation">.</span>sid <span class="token operator">=</span> <span class="token number">71</span> <span class="token operator">and</span>
    v<span class="token punctuation">.</span>statistic<span class="token comment"># = n.statistic#</span>
    <span class="token keyword">order</span> <span class="token keyword">by</span> n<span class="token punctuation">.</span>class<span class="token punctuation">,</span> n<span class="token punctuation">.</span>statistic<span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6839\u636Esid\u67E5\u770B\u5BF9\u5E94\u8FDE\u63A5\u6B63\u5728\u8FD0\u884C\u7684sql</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span>
    command_type<span class="token punctuation">,</span>
    sql_text<span class="token punctuation">,</span>
    sharable_mem<span class="token punctuation">,</span>
    persistent_mem<span class="token punctuation">,</span>
    runtime_mem<span class="token punctuation">,</span>
    sorts<span class="token punctuation">,</span>
    version_count<span class="token punctuation">,</span>
    loaded_versions<span class="token punctuation">,</span>
    open_versions<span class="token punctuation">,</span>
    users_opening<span class="token punctuation">,</span>
    executions<span class="token punctuation">,</span>
    users_executing<span class="token punctuation">,</span>
    loads<span class="token punctuation">,</span>
    first_load_time<span class="token punctuation">,</span>
    invalidations<span class="token punctuation">,</span>
    parse_calls<span class="token punctuation">,</span>
    disk_reads<span class="token punctuation">,</span>
    buffer_gets<span class="token punctuation">,</span>
    rows_processed<span class="token punctuation">,</span>
    sysdate start_time<span class="token punctuation">,</span>
    sysdate finish_time<span class="token punctuation">,</span>
    <span class="token string">&#39;&gt;&#39;</span> <span class="token operator">||</span> address sql_address<span class="token punctuation">,</span>
    <span class="token string">&#39;N&#39;</span> <span class="token keyword">status</span>
    <span class="token keyword">from</span> v$sqlarea
    <span class="token keyword">where</span> address <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sql_address <span class="token keyword">from</span> v$<span class="token keyword">session</span> <span class="token keyword">where</span> sid <span class="token operator">=</span> <span class="token number">71</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u8BE2\u8868\u7A7A\u95F4\u4F7F\u7528\u60C5\u51B5</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> a<span class="token punctuation">.</span>tablespace_name <span class="token string">&quot;\u8868\u7A7A\u95F4\u540D\u79F0&quot;</span><span class="token punctuation">,</span>
    <span class="token number">100</span><span class="token operator">-</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>b<span class="token punctuation">.</span>bytes_free<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">/</span>a<span class="token punctuation">.</span>bytes_alloc<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;\u5360\u7528\u7387(%)&quot;</span><span class="token punctuation">,</span>
    <span class="token function">round</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes_alloc<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;\u5BB9\u91CF(M)&quot;</span><span class="token punctuation">,</span>
    <span class="token function">round</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>b<span class="token punctuation">.</span>bytes_free<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;\u7A7A\u95F2(M)&quot;</span><span class="token punctuation">,</span>
    <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes_alloc<span class="token operator">-</span>nvl<span class="token punctuation">(</span>b<span class="token punctuation">.</span>bytes_free<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;\u4F7F\u7528(M)&quot;</span><span class="token punctuation">,</span>
    Largest <span class="token string">&quot;\u6700\u5927\u6269\u5C55\u6BB5(M)&quot;</span><span class="token punctuation">,</span>
    to_char<span class="token punctuation">(</span>sysdate<span class="token punctuation">,</span><span class="token string">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span class="token punctuation">)</span> <span class="token string">&quot;\u91C7\u6837\u65F6\u95F4&quot;</span>
    <span class="token keyword">from</span>  <span class="token punctuation">(</span><span class="token keyword">select</span> f<span class="token punctuation">.</span>tablespace_name<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>bytes<span class="token punctuation">)</span> bytes_alloc<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>f<span class="token punctuation">.</span>autoextensible<span class="token punctuation">,</span><span class="token string">&#39;YES&#39;</span><span class="token punctuation">,</span>f<span class="token punctuation">.</span>maxbytes<span class="token punctuation">,</span><span class="token string">&#39;NO&#39;</span><span class="token punctuation">,</span>f<span class="token punctuation">.</span>bytes<span class="token punctuation">)</span><span class="token punctuation">)</span> maxbytes
    <span class="token keyword">from</span> dba_data_files f
    <span class="token keyword">group</span> <span class="token keyword">by</span> tablespace_name<span class="token punctuation">)</span> a<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span>  f<span class="token punctuation">.</span>tablespace_name<span class="token punctuation">,</span>
    <span class="token function">sum</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>bytes<span class="token punctuation">)</span> bytes_free
    <span class="token keyword">from</span> dba_free_space f
    <span class="token keyword">group</span> <span class="token keyword">by</span> tablespace_name<span class="token punctuation">)</span> b<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>ff<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> Largest<span class="token punctuation">,</span>
    ts<span class="token punctuation">.</span>name tablespace_name
    <span class="token keyword">from</span> sys<span class="token punctuation">.</span>fet$ ff<span class="token punctuation">,</span> sys<span class="token punctuation">.</span><span class="token keyword">file</span>$ tf<span class="token punctuation">,</span>sys<span class="token punctuation">.</span>ts$ ts
    <span class="token keyword">where</span> ts<span class="token punctuation">.</span>ts<span class="token comment">#=ff.ts# and ff.file#=tf.relfile# and ts.ts#=tf.ts#</span>
    <span class="token keyword">group</span> <span class="token keyword">by</span> ts<span class="token punctuation">.</span>name<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>blocks<span class="token punctuation">)</span> c
    <span class="token keyword">where</span> a<span class="token punctuation">.</span>tablespace_name <span class="token operator">=</span> b<span class="token punctuation">.</span>tablespace_name <span class="token operator">and</span> a<span class="token punctuation">.</span>tablespace_name <span class="token operator">=</span> c<span class="token punctuation">.</span>tablespace_name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u8BE2\u8868\u7A7A\u95F4\u7684\u788E\u7247\u7A0B\u5EA6</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> tablespace_name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>tablespace_name<span class="token punctuation">)</span> <span class="token keyword">from</span> dba_free_space <span class="token keyword">group</span> <span class="token keyword">by</span> tablespace_name
    <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>tablespace_name<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">alter</span> <span class="token keyword">tablespace</span> name <span class="token keyword">coalesce</span><span class="token punctuation">;</span>
    <span class="token keyword">alter</span> <span class="token keyword">table</span> name <span class="token keyword">deallocate</span> unused<span class="token punctuation">;</span>

    <span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">view</span> ts_blocks_v <span class="token keyword">as</span>
    <span class="token keyword">select</span> tablespace_name<span class="token punctuation">,</span>block_id<span class="token punctuation">,</span>bytes<span class="token punctuation">,</span>blocks<span class="token punctuation">,</span><span class="token string">&#39;free space&#39;</span> segment_name <span class="token keyword">from</span> dba_free_space
    <span class="token keyword">union</span> <span class="token keyword">all</span>
    <span class="token keyword">select</span> tablespace_name<span class="token punctuation">,</span>block_id<span class="token punctuation">,</span>bytes<span class="token punctuation">,</span>blocks<span class="token punctuation">,</span>segment_name <span class="token keyword">from</span> dba_extents<span class="token punctuation">;</span>

    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> ts_blocks_v<span class="token punctuation">;</span>

    <span class="token keyword">select</span> tablespace_name<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>block_id<span class="token punctuation">)</span> <span class="token keyword">from</span> dba_free_space
    <span class="token keyword">group</span> <span class="token keyword">by</span> tablespace_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u8BE2\u6709\u54EA\u4E9B\u6570\u636E\u5E93\u5B9E\u4F8B\u5728\u8FD0\u884C</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>    <span class="token keyword">select</span> inst_name <span class="token keyword">from</span> v$active_instances<span class="token punctuation">;</span>
    <span class="token comment">--\u53D6\u5F97\u670D\u52A1\u5668\u7684IP \u5730\u5740</span>
    <span class="token keyword">select</span> utl_inaddr<span class="token punctuation">.</span>get_host_address <span class="token keyword">from</span> dual
    <span class="token comment">--\u53D6\u5F97\u5BA2\u6237\u7AEF\u7684IP\u5730\u5740</span>
    <span class="token keyword">select</span> sys_context<span class="token punctuation">(</span><span class="token string">&#39;userenv&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;host&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sys_context<span class="token punctuation">(</span><span class="token string">&#39;userenv&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;ip_address&#39;</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,69),o=[t];function c(l,u){return s(),a("div",null,o)}const k=n(p,[["render",c],["__file","oralce-dba-sql.html.vue"]]);export{k as default};
